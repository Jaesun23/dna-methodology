# Stage 1: 핵심 정의 가이드 (Core Definition Guide)

> **목적**: 시스템의 본질적 특성을 파악하여 7가지 패밀리 중 하나로 분류
>
> **버전**: v5.0 (2025-12-03)
>
> - v5.0 (2025-12-03): Gemini 연구 기반 10가지 ADQ 체계 도입, DNA_METHODOLOGY_DETAILED.md 기준 전면 재작성
> - v4.0 (2025-11-14): Stage - Part - Layer 구조 재정립
> - v3.0: 3-Layer Decision Tree 도입

---

## 📚 이 가이드의 위치

```
DNA 방법론 문서 체계:

Tier 1: DNA_PROJECT_OVERVIEW_v2.md (전체 맥락)
           ↓
Tier 2: DNA_METHODOLOGY_DETAILED.md (상세 원리)
           ↓
Tier 3: 이 문서 (Stage 1 실행 가이드) ← 지금 여기!
```

**참조 문서**:
- **원리 이해**: `DNA_METHODOLOGY_DETAILED.md` Part 3
- **패밀리별 기술**: `./family-tech-matrix/` (7개 파일)
- **실전 사례**: `./02E-01_stock_trading_case.md`

---

## 📥 입력 문서

**없음** - Stage 1은 프로젝트의 시작점입니다.

**필요한 것**:
- 프로젝트 아이디어 (간단한 설명)
- 해결하고자 하는 문제
- 기본적인 요구사항 (선택적)

---

## 📤 출력 문서

### 필수 산출물 (3개)

| 파일명 | 내용 | 다음 Stage 전달 |
|--------|------|----------------|
| `01C-01_family_classification.md` | 패밀리 코드 + 10가지 ADQ 답변 | ✅ 패밀리 코드 (예: B-C-A) |
| `01C-02_nfr_profile.md` | NFR 우선순위 프로파일 | ✅ NFR 프로파일 (예: A-B-B-A) |
| `01D-01_tech_candidates.md` | 기술 후보군 (family-tech-matrix 기반) | ✅ 기술 방향 |

---

## Part 0: 핵심 기능 파악 ⭐

프로젝트의 시작은 아이디어나 문제 인식에서 출발합니다. 
먼저 **가장 근원적인 기능**과 **비즈니스 목적**을 파악해야 합니다.

### Q0: 이 시스템은 무엇을 하기 위한 시스템인가?

**작성 원칙**:
- 가장 **원자적인 기능(핵심기능)**만 파악
- **구현 방식**을 별개의 기능으로 보지 않음
- **비즈니스 목적**으로 구분

**예시**:
```
❌ 잘못된 구분:
   - 수동 거래 (기능 1)
   - 자동 거래 (기능 2)

✅ 올바른 구분:
   - 거래 (핵심기능)
     ├─ 구현 방식 A: 수동
     └─ 구현 방식 B: 자동
   - 비즈니스 목적: 계약 체결로 법적 소유권 이전 

✅ 다른 예시:
   - AI 챗봇 + 외부메모리 (X) → AI 외부메모리 (CRUD) (O)
   - 일반 검색 + AI 검색 (X) → 검색 (O)
```

---

## Part 1: 10가지 ADQ (Architecture-Driving Questions)

> **핵심 원칙**: "질문이 결론을 이끈다"
>
> 10가지 질문에 답하면 패밀리와 NFR이 자연스럽게 도출됩니다.


### 카테고리 A: 비즈니스 가치

#### Q1: "이 시스템이 1시간 동안 멈추면 어떤 일이 일어나나요?"

**목적**: 실패의 치명도 판단 → Layer 1 결정

| 답변 | 의미 | 예시 |
|------|------|------|
| **A (치명적)** | 금전/인명/법적 피해 | 주식 거래: "1시간 정지 = 수억 원 손실" |
| **B (심각)** | 비즈니스 영향, 고객 불만 | 병원 예약: "환자 대기, 심각한 불편" |
| **C (경미)** | 불편함, 대체 수단 존재 | 블로그: "불편하지만 치명적이진 않음" |

---

#### Q2: "고객이 이 시스템에서 가장 중요하게 생각하는 것은?"

**목적**: 핵심 품질 속성 식별 → NFR 우선순위

| 답변 | 의미 | 전형적 시스템 |
|------|------|-------------|
| **속도** | "빨라야 함", "즉시 응답" | 검색 엔진 (0.1초 내 결과) |
| **정확성** | "틀리면 안 됨", "100% 정확" | 은행 이체 (1원도 틀리면 안 됨) |
| **가용성** | "항상 접속 가능", "24/7" | 채팅 앱 |
| **보안** | "절대 유출 안 됨" | 의료 시스템 |
| **비용** | "저렴해야 함" | 내부 도구 |

---

### 카테고리 B: 사용자/규모

#### Q3: "사용자가 이 시스템에서 가장 자주 하는 행동 3가지는?"

**목적**: 핵심 사용자 여정 파악 → Layer 3 참고

**답변 형식**:
```
1. [행동 1] - 빈도: 일 N회, 소요시간: N초
2. [행동 2] - 빈도: 일 N회, 소요시간: N초
3. [행동 3] - 빈도: 일 N회, 소요시간: N초
```

**예시 (이커머스)**:
```
1. 상품 검색 - 일 100회, 1초 이내
2. 상품 상세 보기 - 일 50회, 3초 이내
3. 주문하기 - 일 5회, 30초 이내
```

---

#### Q4: "동시에 이 시스템을 사용하는 사용자는 얼마나 되나요?"

**목적**: 확장성 요구사항 파악

| 답변 | 규모 | 아키텍처 영향 |
|------|------|-------------|
| **A (소규모)** | 10-100명 | 단일 서버 가능 |
| **B (중규모)** | 100-10,000명 | 수평 확장 고려 |
| **C (대규모)** | 10,000-100,000명 | 분산 아키텍처 필수 |
| **D (초대규모)** | 100,000명+ | 글로벌 분산 |

**추가 질문**:
- 피크 시간대는? (출퇴근, 점심, 이벤트)
- 성장 예상치는? (월 N% 증가)

---

### 카테고리 C: 데이터/의존성

#### Q5: "이 시스템에서 다루는 데이터 중 가장 민감한 것은?"

**목적**: 보안 수준 결정 → Layer 2, NFR

| 답변 | 데이터 유형 | 규제 연결 |
|------|-----------|----------|
| **A (극비)** | 금융, 의료, 생체 | PCI-DSS, HIPAA |
| **B (민감)** | 개인정보, 위치 | GDPR, 개인정보보호법 |
| **C (내부)** | 비즈니스 데이터 | 내부 정책 |
| **D (공개)** | 공개 콘텐츠 | 없음 |

---

#### Q6: "데이터는 어디서 오나요? (원천)"

**목적**: 통합 복잡도 파악 → Layer 2

| 답변 | 원천 | 예시 |
|------|------|------|
| **자체 생성** | 사용자 입력, 시스템 생성 | 게시글, 주문 |
| **외부 API** | 증권사, 결제, 지도 | KIS API, Stripe |
| **데이터 피드** | 실시간 시세, 뉴스 | WebSocket 피드 |
| **배치 수집** | 일별 정산, 크롤링 | ETL 파이프라인 |
| **사용자 업로드** | 파일, 이미지 | S3 업로드 |

---

#### Q7: "데이터는 얼마나 오래 보관해야 하나요?"

**목적**: 저장소 설계, 아카이빙 전략

| 답변 | 기간 | 저장소 전략 |
|------|------|-----------|
| **실시간** | 현재 상태만 | 캐시, 세션 |
| **단기** | 7-30일 | 로그, 임시 |
| **중기** | 1-5년 | 거래 내역, 활동 |
| **장기** | 5년+ | 법적 보관, 감사 |
| **영구** | 삭제 불가 | 블록체인, 아카이브 |

---

### 카테고리 D: 운영/환경

#### Q8: "이 시스템이 연동해야 하는 외부 시스템은?"

**목적**: 의존성 파악, 장애 전파 범위

**답변 형식**:
| 시스템 | 연동 방식 | 의존도 | 대체 가능 |
|--------|----------|--------|----------|
| KIS API | REST | 필수 | X |
| Slack | Webhook | 선택 | O (이메일) |

---

#### Q9: "시스템은 어디에 배포되나요?"

**목적**: 인프라 제약 파악

| 답변 | 환경 | 고려사항 |
|------|------|---------|
| **클라우드** | AWS, GCP, Azure | 관리형 서비스 활용 |
| **온프레미스** | 자체 서버, IDC | 직접 운영 |
| **하이브리드** | 클라우드 + 온프레미스 | 연결 복잡도 |
| **엣지** | IoT, CDN, 로컬 | 지연시간 최적화 |

---

#### Q10: "시스템은 얼마나 자주 변경되나요?"

**목적**: 유지보수 전략, 배포 파이프라인

| 답변 | 빈도 | CI/CD 요구 |
|------|------|-----------|
| **초고빈도** | 일 수회 | 완전 자동화 필수 |
| **고빈도** | 주 1-2회 | 자동화 권장 |
| **중빈도** | 월 1-2회 | 반자동화 |
| **저빈도** | 분기 1회 | 수동 가능 |

---


## Part 2: 3-Layer Decision Tree → 패밀리 코드 도출

10가지 ADQ 답변을 3개 Layer로 매핑하여 패밀리 코드를 도출합니다.

### ADQ → Layer 매핑

```
Layer 1 (실패 영향): Q1 기반
├─ A: 치명적 (금전/인명/법적)
└─ B: 점진적 (불편함, 재시도 가능)

Layer 2 (데이터 형태): Q5, Q6 기반
├─ A: 구조화 (고정 스키마, RDBMS)
├─ B: 반구조화 (JSON, 유연한 스키마)
└─ C: 비구조화 (스트림, 로그, 자연어)

Layer 3 (응답 시점): Q3 기반
├─ A: 밀리초 (<100ms, 실시간)
├─ B: 초 단위 (1-10초, 대화형)
└─ C: 배치 (분~시간)
```

### 7가지 패밀리

| 코드 | 패밀리명 | 특성 | 대표 사례 | 기술 매트릭스 |
|------|---------|------|----------|-------------|
| **A-A-A** | 초고속 거래 | 치명적, 구조화, 마이크로초 | NASDAQ (14μs), HFT | `01_ultra_high_frequency_trading_tech_options.md` |
| **A-A-B** | 트랜잭션/CRUD | 치명적, 구조화, 초 | Amazon 주문, Stripe | `02_transaction_crud_tech_options.md` |
| **B-A-A** | 협업/동기화 | 점진적, 구조화, 밀리초 | Google Docs, Figma | `03_collaboration_sync_tech_options.md` |
| **B-B-B** | 검색/추천 | 점진적, 반구조화, 초 | Elasticsearch, AI 외부메모리 | `04_search_recommendation_tech_options.md` |
| **B-C-A** | 실시간 스트리밍 | 점진적, 비구조화, 밀리초 | Netflix, Uber GPS | `05_real_time_streaming_tech_options.md` |
| **B-A-C** | 분석/배치 | 점진적, 구조화, 배치 | Snowflake, BigQuery | `06_analytics_batch_tech_options.md` |
| **A-B-A** | 안전-임계 IoT | 치명적, 반구조화, 밀리초 | SCADA, 의료기기 | `07_safety_critical_iot_tech_options.md` |

### 패밀리 선택 플로우차트

```
시작: 프로젝트 아이디어
  ↓
[Q1] 1시간 멈추면?
  ├─ 금전/인명/법적 손실 → A (치명적)
  └─ 불편함, 재시도 가능 → B (점진적)
       ↓
[Q5, Q6] 데이터 형태는?
  ├─ 고정 스키마, 관계형 → A (구조화)
  ├─ JSON, 유연한 스키마 → B (반구조화)
  └─ 이벤트, 로그, 스트림 → C (비구조화)
       ↓
[Q3] 응답 속도는?
  ├─ 즉시 (<100ms) → A (밀리초)
  ├─ 기다림 (1-10초) → B (초)
  └─ 나중에 (분~시간) → C (배치)
       ↓
패밀리 코드 확정! (예: B-C-A)
  ↓
해당 패밀리 기술 매트릭스 참고
→ ./family-tech-matrix/05_real_time_streaming_tech_options.md
```

---

## Part 3: NFR 프로파일 도출

### NFR 5가지 품질 속성 (SEI Quality Attributes 기반)

Q1, Q2, Q3, Q4, Q5 답변을 기반으로 NFR 프로파일을 도출합니다.

```
NFR 프로파일: [정확성]-[속도]-[가용성]-[보안]-[비용]

예: A-B-A-A-B
├─ 정확성: A (100% 정확해야 함)
├─ 속도: B (1초 이내면 충분)
├─ 가용성: A (99.9%+ 가동률)
├─ 보안: A (극비 수준)
└─ 비용: B (중간 예산)
```

### 각 속성 등급 기준

| 속성 | A 등급 | B 등급 | C 등급 | 근거 ADQ |
|------|--------|--------|--------|----------|
| **정확성** | 100% 정확 필수 | 99%+ 허용 | 95%+ 허용 | Q2 |
| **속도** | <100ms 실시간 | <1초 준실시간 | 배치 허용 | Q3 |
| **가용성** | 99.9%+ (연 8.7시간 이하 장애) | 99%+ | 95%+ | Q1 |
| **보안** | 극비 (금융, 의료) | 민감 (개인정보) | 공개 가능 | Q5 |
| **비용** | 무제한 | 중간 (예산 내) | 최소화 | 예산 제약 |

### 컨텍스트 정보 (별도 기록)

NFR 프로파일과 별도로, 환경 조건을 기록합니다:

| 항목 | 값 예시 | 근거 ADQ |
|------|---------|----------|
| **규모** | 중규모 (10만 사용자) | Q4 |
| **최신성** | 실시간 (<100ms) | Q3 |
| **데이터량** | 일 100만 건 | Q7 |
| **보관 기간** | 5년 | Q7 |

### NFR 충돌 패턴 감지 ⚠️

**5차원 프로파일에서 충돌 패턴 식별**:

| 충돌 패턴 | 조건 | 이론적 근거 | 해결 방향 |
|----------|------|------------|----------|
| **정확성 vs 속도** | 둘 다 A | CAP Theorem (C vs Latency) | 쓰기=동기, 읽기=캐시 |
| **가용성 vs 정확성** | 둘 다 A | CAP Theorem (A vs C) | 정상=둘 다, 장애=정확성 우선 |
| **속도 vs 보안** | 둘 다 A | 암호화 오버헤드 | 인증 후 고속 처리 |
| **가용성 vs 비용** | A + C | 고가용성=고비용 | 중요 컴포넌트만 HA |

⚠️ **충돌 발견 시**: Stage 2 Part 2에서 트레이드오프 결정 필수!

---


## 📋 템플릿

### 01C-01_family_classification.md 템플릿

```markdown
# 패밀리 분류 문서

**프로젝트**: [프로젝트명]
**작성일**: [YYYY-MM-DD]
**작성자**: [이름]

---

## Part 0: 핵심 기능

### Q0: 존재 이유
- **핵심 기능**: [기능명]
- **비즈니스 목적**: [목적]
- **구현 방식들**: [A, B, C...]

---

## Part 1: 10가지 ADQ 답변

### 카테고리 A: 비즈니스 가치

**Q1: 1시간 멈추면?**
- 답변: [A/B/C]
- 이유: [구체적 설명]

**Q2: 고객이 가장 중요하게 생각하는 것?**
- 답변: [속도/정확성/가용성/보안/비용]
- 이유: [구체적 설명]

### 카테고리 B: 사용자/규모

**Q3: 가장 자주 하는 행동 3가지?**
1. [행동 1] - 빈도: 일 N회, 소요시간: N초
2. [행동 2] - 빈도: 일 N회, 소요시간: N초
3. [행동 3] - 빈도: 일 N회, 소요시간: N초

**Q4: 동시 사용자 규모?**
- 답변: [A/B/C/D]
- 피크 시간대: [시간]
- 성장 예상: [월 N%]

### 카테고리 C: 데이터/의존성

**Q5: 가장 민감한 데이터?**
- 답변: [A/B/C/D]
- 데이터 유형: [구체적 데이터]
- 관련 규제: [규제명]

**Q6: 데이터 원천?**
- [ ] 자체 생성
- [ ] 외부 API: [API명]
- [ ] 데이터 피드: [피드 유형]
- [ ] 배치 수집
- [ ] 사용자 업로드

**Q7: 데이터 보관 기간?**
- 답변: [실시간/단기/중기/장기/영구]
- 이유: [법적 요건 등]

### 카테고리 D: 운영/환경

**Q8: 연동 외부 시스템?**
| 시스템 | 연동 방식 | 의존도 | 대체 가능 |
|--------|----------|--------|----------|
| [시스템1] | [방식] | [필수/선택] | [O/X] |

**Q9: 배포 환경?**
- 답변: [클라우드/온프레미스/하이브리드/엣지]
- 상세: [AWS/GCP 등]

**Q10: 변경 빈도?**
- 답변: [초고빈도/고빈도/중빈도/저빈도]
- CI/CD 요구: [수준]

---

## Part 2: 패밀리 코드 도출

### Layer 매핑
- Layer 1 (Q1 → 실패 영향): [A/B]
- Layer 2 (Q5,Q6 → 데이터 형태): [A/B/C]
- Layer 3 (Q3 → 응답 시점): [A/B/C]

### 📌 패밀리 코드: [X-X-X]
### 📌 패밀리명: [패밀리 이름]

---

## Part 3: 기술 방향

**참조**: `./family-tech-matrix/[해당 파일].md`

### 필수 기술 방향
- ✅ [방향 1]
- ✅ [방향 2]
- ✅ [방향 3]

### 기술 후보군
- [기술 1], [기술 2], [기술 3]
```

---

### 01C-02_nfr_profile.md 템플릿

```markdown
# NFR 프로파일 문서

**프로젝트**: [프로젝트명]
**작성일**: [YYYY-MM-DD]

---

## NFR 5가지 품질 속성 (SEI Quality Attributes 기반)

| 속성 | 등급 | 의미 | 근거 (ADQ) |
|------|------|------|-----------|
| **정확성** | [A/B/C] | [100% 정확 / 99%+ / 95%+] | Q2: [이유] |
| **속도** | [A/B/C] | [<100ms / <1초 / 배치] | Q3: [이유] |
| **가용성** | [A/B/C] | [99.9%+ / 99%+ / 95%+] | Q1: [이유] |
| **보안** | [A/B/C] | [극비 / 민감 / 공개] | Q5: [이유] |
| **비용** | [A/B/C] | [무제한 / 중간 / 최소화] | 예산: [금액] |

### 📌 NFR 프로파일: [X-X-X-X-X]

---

## 컨텍스트 정보

| 항목 | 값 | 근거 (ADQ) |
|------|-----|-----------|
| 규모 | [소/중/대/초대규모] | Q4: [동시 사용자 수] |
| 최신성 | [실시간/준실시간/배치] | Q3: [사용자 기대] |
| 데이터량 | [일 N건] | Q7: [추정 근거] |
| 보관 기간 | [N년] | Q7: [법적/비즈니스 요건] |

---

## 충돌 패턴 분석

### 잠재적 충돌 체크
- [ ] 정확성 A + 속도 A → CAP Theorem 충돌 가능
- [ ] 가용성 A + 정확성 A → CAP Theorem 충돌 가능
- [ ] 속도 A + 보안 A → 암호화 오버헤드
- [ ] 가용성 A + 비용 C → 고가용성=고비용

### 발견된 충돌
| 충돌 | 설명 | Stage 2 분석 필요? |
|------|------|-------------------|
| [충돌 1] | [설명] | ✅/❌ |
| [충돌 2] | [설명] | ✅/❌ |

### Stage 2 전달 사항
- [Stage 2에서 상세 분석 필요한 충돌 목록]
```

---

### 01D-01_tech_candidates.md 템플릿

```markdown
# 기술 후보군 문서

**프로젝트**: [프로젝트명]
**작성일**: [YYYY-MM-DD]
**패밀리 코드**: [X-X-X]

---

## 패밀리 기반 기술 방향

**참조**: `./family-tech-matrix/[해당 파일].md`

### 이 패밀리의 필수 특성
- ✅ [특성 1] (예: ACID 트랜잭션 필수)
- ✅ [특성 2] (예: 실시간 처리)
- ✅ [특성 3] (예: 강한 일관성)

---

## 기술 후보군

### 데이터베이스
| 후보 | 장점 | 단점 | 적합도 |
|------|------|------|--------|
| [DB 1] | [장점] | [단점] | ⭐⭐⭐ |
| [DB 2] | [장점] | [단점] | ⭐⭐ |
| [DB 3] | [장점] | [단점] | ⭐ |

### 프레임워크
| 후보 | 장점 | 단점 | 적합도 |
|------|------|------|--------|
| [FW 1] | [장점] | [단점] | ⭐⭐⭐ |
| [FW 2] | [장점] | [단점] | ⭐⭐ |

### 메시징/캐시
| 후보 | 장점 | 단점 | 적합도 |
|------|------|------|--------|
| [기술 1] | [장점] | [단점] | ⭐⭐⭐ |
| [기술 2] | [장점] | [단점] | ⭐⭐ |

---

## Stage 2 검토 필요 사항

- [ ] [후보 1] vs [후보 2] 성능 비교
- [ ] [기술 X] 팀 역량 확인
- [ ] [기술 Y] 비용 분석
```

---

## ✅ Stage 1 완료 체크리스트

```
□ Part 0: 핵심 기능 파악 완료
□ Part 1: 10가지 ADQ 모두 답변
□ Part 2: 패밀리 코드 도출 (X-X-X)
□ Part 3: NFR 프로파일 도출 (X-X-X-X-X)
□ 산출물 생성:
  □ 01C-01_family_classification.md
  □ 01C-02_nfr_profile.md
  □ 01D-01_tech_candidates.md (family-tech-matrix 참조)
□ 충돌 패턴 기록 (있는 경우)
```

---

## 🔜 다음 단계

### Stage 1 → Stage 2 전달 사항

| 항목 | 예시 | Stage 2에서 사용 |
|------|------|----------------|
| 패밀리 코드 | B-C-A | 기술 스택 결정 기준 |
| 핵심 기능 | 거래 | 도메인 설계 기준 |
| NFR 프로파일 | A-B-B-A | 트레이드오프 결정 |
| 기술 후보군 | Kafka, Redis, PostgreSQL | 비교 평가 대상 |
| 충돌 패턴 | 속도 vs 정확성 | Stage 2에서 해결 |

### Stage 2에서 할 일
- 🔄 외부 제약 상세 조사 (API 비교, 법규 등)
- 🔄 충돌 패턴 해결 방안 도출
- 🔄 기술 스택 최종 확정
- 🔄 결정 요소 목록 작성 (ADR 준비)

**다음 문서**: `02G-00_environment_constraints_guide.md`

---

## 📚 참고 문서

| 문서 | 용도 |
|------|------|
| `DNA_METHODOLOGY_DETAILED.md` Part 3 | 10가지 ADQ 상세 원리 |
| `./family-tech-matrix/*.md` | 7가지 패밀리별 기술 선택 |
| `./02E-01_stock_trading_case.md` | 실전 사례 (주식 거래 플랫폼) |
| `./standards/00_STAGE_STRUCTURE.md` | Stage 간 연결 구조 |

---

**버전 이력**:
- v5.0 (2025-12-03): Gemini 연구 기반 10가지 ADQ 체계 도입, DNA_METHODOLOGY_DETAILED.md 기준 전면 재작성
- v4.0 (2025-11-14): Stage - Part - Layer 구조 재정립
- v3.0 (2025-11-12): 3-Layer Decision Tree 도입
- v2.0 (2025-11-11): 초기 버전
