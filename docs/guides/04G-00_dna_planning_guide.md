# Stage 4: DNA ì‹œìŠ¤í…œ ì²­ì‚¬ì§„ ê°€ì´ë“œ (DNA Blueprint Guide)

> **ëª©ì **: Stage 3 ADR ê¸°ë°˜ìœ¼ë¡œ DNA ì‹œìŠ¤í…œ 11ê°œì˜ ì„¤ê³„ ì²­ì‚¬ì§„ ì‘ì„±
>
> **ë²„ì „**: v4.1 (2025-12-03)
>
> - v5.0 (2025-12-03): Gemini ì—°êµ¬ ê¸°ë°˜ ì „ë©´ ì¬ì‘ì„±, DNA_METHODOLOGY_DETAILED.md ê¸°ì¤€
> - v1.0 (2025-11-13): ì´ˆê¸° ë²„ì „

---

## ğŸ“š ì´ ê°€ì´ë“œì˜ ìœ„ì¹˜

```
DNA ë°©ë²•ë¡  ë¬¸ì„œ ì²´ê³„:

Tier 1: DNA_PROJECT_OVERVIEW_v2.md (ì „ì²´ ë§¥ë½)
           â†“
Tier 2: DNA_METHODOLOGY_DETAILED.md (ìƒì„¸ ì›ë¦¬) - Part 5
           â†“
Tier 3: ì´ ë¬¸ì„œ (Stage 4 ì‹¤í–‰ ê°€ì´ë“œ) â† ì§€ê¸ˆ ì—¬ê¸°!
```

**ì°¸ì¡° ë¬¸ì„œ**:
- **ì›ë¦¬ ì´í•´**: `DNA_METHODOLOGY_DETAILED.md` Part 5
- **DNA ìƒì„¸**: `DNA_Systems_11_Complete_Guide.md`

---

## ğŸ§¬ DNA ë°©ë²•ë¡  4ëŒ€ í•µì‹¬ ì›ì¹™ (Stage 4 ì ìš©)

> **"AIê°€ í•œ ì„¸ì…˜ì—ì„œ ìµœê³  ì„±ê³¼ë¥¼ ë‚¼ ìˆ˜ ìˆëŠ” í¬ê¸°ë¡œ ì‘ì—…í•˜ê³ , ì™„ì „í•´ì§ˆ ë•Œê¹Œì§€ ë°˜ë³µí•˜ë©°, ì˜¤ë¥˜ ë°œê²¬ ì‹œ ë˜ëŒì•„ê°€ì„œ ìˆ˜ì •í•œë‹¤"**

Stage 4 (DNA ì‹œìŠ¤í…œ ì²­ì‚¬ì§„)ì—ì„œ DNA 4ëŒ€ í•µì‹¬ ì›ì¹™ì´ ì ìš©ë˜ëŠ” ë°©ì‹:

---

### DNA í•µì‹¬ ì›ì¹™ 1: AI ìµœì  í¬ê¸°

**"ì»¨í…ìŠ¤íŠ¸ ë²”ìœ„ ë‚´ì—ì„œ ì‘ì—…í•œë‹¤"**

#### Stage 4ì˜ ì‘ì—… í¬ê¸° ì „ëµ

```
âŒ ì˜ëª»ëœ ì ‘ê·¼: 11ê°œ DNA ì‹œìŠ¤í…œ ì²­ì‚¬ì§„ í•œ ë²ˆì—
"11ê°œ DNA ì‹œìŠ¤í…œ ì²­ì‚¬ì§„ì„ í•œ ì„¸ì…˜ì—ì„œ ëª¨ë‘ ì‘ì„±í•˜ì„¸ìš”"
â†’ ì»¨í…ìŠ¤íŠ¸ ì´ˆê³¼ (200K í† í° í•œê³„)
â†’ í›„ë°˜ë¶€ ì²­ì‚¬ì§„ í’ˆì§ˆ ì €í•˜ (ìƒì„¸ë„ ê°ì†Œ)
â†’ ì‹œìŠ¤í…œ ê°„ ì¼ê´€ì„± ë¶€ì¡±

âœ… ì˜¬ë°”ë¥¸ ì ‘ê·¼: ì‹œìŠ¤í…œ ìœ í˜•ë³„ ìˆœì°¨ ì‘ì„±
Session 1: ê¸°ì´ˆ ì‹œìŠ¤í…œ (Logging + Types)
Session 2: ë°ì´í„° ì‹œìŠ¤í…œ (Database + Cache)
Session 3: í†µì‹  ì‹œìŠ¤í…œ (Messaging + API Gateway)
Session 4: ë³´ì•ˆ/ìš´ì˜ ì‹œìŠ¤í…œ (Security + Monitoring)
Session 5: ì„¤ì •/í…ŒìŠ¤íŠ¸/ì—ëŸ¬ (Config + Testing + Error)

ê° ì„¸ì…˜: 2-3ê°œ ì‹œìŠ¤í…œ, 80-90K í† í° ë²”ìœ„
```

#### ì»¨í…ìŠ¤íŠ¸ êµ¬ì„± (ê° ì„¸ì…˜)

```
Claude 200K í† í° ìœˆë„ìš°:
â”œâ”€ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸: ~30K í† í°
â”œâ”€ ëŒ€í™” íˆìŠ¤í† ë¦¬: ~20K í† í°
â”œâ”€ Stage 3 ì°¸ì¡° ë¬¸ì„œ: ~30-40K í† í°
â”‚   â”œâ”€ 03A-401_dna_logging.md (ADR)
â”‚   â”œâ”€ 03A-402_dna_types.md (ADR)
â”‚   â””â”€ 03A-000_adr_index.md (ì¸ë±ìŠ¤)
â”œâ”€ DNA ì‹œìŠ¤í…œ ê°€ì´ë“œ: ~20K í† í°
â”‚   â””â”€ DNA_Systems_11_Complete_Guide.md (í•´ë‹¹ ì„¹ì…˜)
â”œâ”€ ì‘ì—… ì¤‘ ì²­ì‚¬ì§„ ì‘ì„±: ~20K í† í° (2-3ê°œ Ã— 8-10K)
â””â”€ ì‘ë‹µ ìƒì„± ì—¬ìœ : ~80K í† í°
```

#### ì„¸ì…˜ë‹¹ ì‘ì—…ëŸ‰ ê¸°ì¤€

| ì„¸ì…˜ | DNA ì‹œìŠ¤í…œ | ì²­ì‚¬ì§„ í¬ê¸° | ì´ í† í° |
|-----|-----------|-----------|---------|
| Session 1 | Logging, Types | ê° 8-10K | ~20K |
| Session 2 | Database, Cache | ê° 10-12K | ~24K |
| Session 3 | Messaging, API Gateway | ê° 8-10K | ~20K |
| Session 4 | Security, Monitoring | ê° 8-10K | ~20K |
| Session 5 | Config, Testing, Error | ê° 6-8K | ~21K |

**í•µì‹¬**: í•œ ì„¸ì…˜ì— 2-3ê°œ DNA ì‹œìŠ¤í…œ ì²­ì‚¬ì§„ì´ ìµœì 

#### ê·¸ë£¹í™” ì›ì¹™: ì˜ì¡´ì„± ê¸°ë°˜

```
ê·¸ë£¹ 1: ê¸°ì´ˆ (Foundation)
â”œâ”€ Logging: ë¡œê·¸ ì¶œë ¥
â””â”€ Types: íƒ€ì… ì •ì˜
  â†’ ë‹¤ë¥¸ ëª¨ë“  ì‹œìŠ¤í…œì´ ì˜ì¡´

ê·¸ë£¹ 2: ë°ì´í„° (Data)
â”œâ”€ Database: ì˜êµ¬ ì €ì¥
â””â”€ Cache: ì„ì‹œ ì €ì¥
  â†’ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ì˜ì¡´

ê·¸ë£¹ 3: í†µì‹  (Communication)
â”œâ”€ Messaging: ë¹„ë™ê¸° í†µì‹ 
â””â”€ API Gateway: HTTP í†µì‹ 
  â†’ ì™¸ë¶€ ì—°ë™ì´ ì˜ì¡´

ê·¸ë£¹ 4: ë³´ì•ˆ/ìš´ì˜ (Security/Ops)
â”œâ”€ Security: ì¸ì¦/ì¸ê°€
â””â”€ Monitoring: ê´€ì°°ì„±
  â†’ í”„ë¡œë•ì…˜ ë°°í¬ í•„ìˆ˜

ê·¸ë£¹ 5: ì§€ì› (Support)
â”œâ”€ Config: ì„¤ì • ê´€ë¦¬
â”œâ”€ Testing: í…ŒìŠ¤íŠ¸ ë„êµ¬
â””â”€ Error: ì—ëŸ¬ ì²˜ë¦¬
  â†’ ê°œë°œ/ë°°í¬ ì§€ì›
```

---

### DNA í•µì‹¬ ì›ì¹™ 2: ì™„ì „í•´ì§ˆ ë•Œê¹Œì§€ ë°˜ë³µ

**"ë¶€ì¡±í•˜ë©´ ë°˜ë³µí•´ì„œ ë¶€ì¡±í•¨ì´ ì—†ì–´ì§ˆ ë•Œê¹Œì§€"**

#### DNA ì‹œìŠ¤í…œ ì²­ì‚¬ì§„ ì™„ì „ì„± ê¸°ì¤€

ê° DNA ì‹œìŠ¤í…œ ì²­ì‚¬ì§„ì€ ë‹¤ìŒì„ ëª¨ë‘ í¬í•¨í•´ì•¼ í•¨:

```
âœ… ì™„ì „í•œ DNA ì²­ì‚¬ì§„ ì²´í¬ë¦¬ìŠ¤íŠ¸:
â–¡ 1. ëª©ì  ë° ë²”ìœ„ (Purpose & Scope)
   - ì´ ì‹œìŠ¤í…œì´ í•´ê²°í•˜ëŠ” ë¬¸ì œ
   - ë‹´ë‹¹ ë²”ìœ„ì™€ ì±…ì„
   - ë‹¤ë¥¸ ì‹œìŠ¤í…œê³¼ì˜ ê²½ê³„

â–¡ 2. ê³µê°œ API (Public API)
   - í•¨ìˆ˜/í´ë˜ìŠ¤ ì‹œê·¸ë‹ˆì²˜
   - ì…ë ¥/ì¶œë ¥ íƒ€ì…
   - ì‚¬ìš© ì˜ˆì‹œ (ì½”ë“œ)

â–¡ 3. ë””ë ‰í† ë¦¬ êµ¬ì¡° (Directory Structure)
   - íŒŒì¼ ëª©ë¡ê³¼ ì—­í• 
   - ëª¨ë“ˆ ê°„ ì˜ì¡´ì„±
   - ëª…ëª… ê·œì¹™

â–¡ 4. í•µì‹¬ ì„¤ê³„ ê²°ì • (Design Decisions)
   - ADR ì°¸ì¡° (ëª…ì‹œì )
   - ì•„í‚¤í…ì²˜ íŒ¨í„´
   - ì„±ëŠ¥/ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

â–¡ 5. ì˜ì¡´ì„± (Dependencies)
   - ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ (ë²„ì „ ëª…ì‹œ)
   - ë‹¤ë¥¸ DNA ì‹œìŠ¤í…œ ì˜ì¡´
   - ìˆœí™˜ ì˜ì¡´ì„± ì—†ìŒ ë³´ì¥

â–¡ 6. í…ŒìŠ¤íŠ¸ ì „ëµ (Testing Strategy)
   - ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë²”ìœ„
   - í†µí•© í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
   - ëª©í‘œ ì»¤ë²„ë¦¬ì§€ (95%+)

â–¡ 7. êµ¬í˜„ ìš°ì„ ìˆœìœ„ (Implementation Priority)
   - ì–´ë–¤ íŒŒì¼ë¶€í„° êµ¬í˜„?
   - ì˜ì¡´ì„± ìˆœì„œ
   - Stage 5 ì‘ì—… ë‹¨ìœ„
```

#### 3ë‹¨ê³„ ê²€ì¦ í”„ë¡œí† ì½œ

```python
def validate_dna_blueprint_session(blueprints: list[Blueprint]) -> ValidationResult:
    """DNA ì²­ì‚¬ì§„ ì„¸ì…˜ ì™„ì „ì„± ê²€ì¦."""

    # ê²€ì¦ 1: ê° ì²­ì‚¬ì§„ êµ¬ì¡° ê²€ì¦
    for bp in blueprints:
        if not all([
            bp.has_purpose_and_scope(),
            bp.has_public_api(),
            bp.has_directory_structure(),
            bp.has_design_decisions(),
            bp.has_dependencies(),
            bp.has_testing_strategy(),
            bp.has_implementation_priority()
        ]):
            return ValidationResult(
                passed=False,
                message=f"Blueprint {bp.name}: 7ê°œ ì„¹ì…˜ ì¤‘ ëˆ„ë½ ë°œê²¬",
                action="í•´ë‹¹ ì²­ì‚¬ì§„ ì¬ì‘ì„±"
            )

    # ê²€ì¦ 2: ì˜ì¡´ì„± ì¼ê´€ì„± ê²€ì¦
    for bp in blueprints:
        for dep in bp.dependencies:
            if dep not in [b.name for b in blueprints] and not dep.startswith("external:"):
                return ValidationResult(
                    passed=False,
                    message=f"Blueprint {bp.name}: ì •ì˜ë˜ì§€ ì•Šì€ ì˜ì¡´ì„± {dep}",
                    action="ì˜ì¡´ì„± ì¶”ê°€ ë˜ëŠ” ì œê±°"
                )

    # ê²€ì¦ 3: ADR ì¶”ì ì„± ê²€ì¦
    for bp in blueprints:
        if not bp.has_adr_references():
            return ValidationResult(
                passed=False,
                message=f"Blueprint {bp.name}: ADR ì°¸ì¡° ëˆ„ë½",
                action="Stage 3 ADR ì°¸ì¡° ì¶”ê°€"
            )

    # ê²€ì¦ 4: ìˆœí™˜ ì˜ì¡´ì„± ê²€ì¦
    if has_circular_dependency(blueprints):
        return ValidationResult(
            passed=False,
            message="ìˆœí™˜ ì˜ì¡´ì„± ë°œê²¬",
            action="ì˜ì¡´ì„± ë°©í–¥ ì¬ì„¤ê³„"
        )

    return ValidationResult(passed=True)
```

#### ë¶ˆì™„ì „ â†’ ì¬ì‘ì„± ì‚¬ë¡€

```markdown
## ì‚¬ë¡€: DNA Logging ì‹œìŠ¤í…œ ì²­ì‚¬ì§„

### âŒ ë¶ˆì™„ì „í•œ ë²„ì „ (1ì°¨ ì‘ì„±)
**ëª©ì **: ë¡œê·¸ë¥¼ ê¸°ë¡í•œë‹¤
**API**: `log(message: str)`
**êµ¬ì¡°**: `logging.py` í•˜ë‚˜

âŒ ë¬¸ì œì :
- ë²”ìœ„ ë¶ˆëª…í™• (ì½˜ì†”? íŒŒì¼? ì™¸ë¶€ ì „ì†¡?)
- API ë„ˆë¬´ ë‹¨ìˆœ (ë ˆë²¨ì€? ì»¨í…ìŠ¤íŠ¸ëŠ”?)
- êµ¬ì¡° ë¶ˆì¶©ë¶„ (ì„¤ì •ì€? í¬ë§·í„°ëŠ”?)
- ADR ì°¸ì¡° ì—†ìŒ
- ì˜ì¡´ì„± ëª…ì‹œ ì—†ìŒ
- í…ŒìŠ¤íŠ¸ ì „ëµ ì—†ìŒ
- êµ¬í˜„ ìˆœì„œ ì—†ìŒ

### âœ… ì™„ì „í•œ ë²„ì „ (2ì°¨ ì¬ì‘ì„±)

#### 1. ëª©ì  ë° ë²”ìœ„
**ë¬¸ì œ**: ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ ì¶”ì  ê°€ëŠ¥í•œ êµ¬ì¡°í™”ëœ ë¡œê·¸ í•„ìš”
**ë²”ìœ„**:
- êµ¬ì¡°í™”ëœ ë¡œê·¸ (JSON)
- ì»¨í…ìŠ¤íŠ¸ ìë™ ì¶”ê°€ (request_id, user_id ë“±)
- ë‹¤ì¤‘ ì¶œë ¥ (ì½˜ì†” + íŒŒì¼ + ì™¸ë¶€)
**ì œì™¸**: ë¡œê·¸ ìˆ˜ì§‘/ë¶„ì„ (ì™¸ë¶€ ì‹œìŠ¤í…œ)

#### 2. ê³µê°œ API
```python
from core.logging import get_logger, LogLevel

# ê¸°ë³¸ ì‚¬ìš©
logger = get_logger(__name__)
logger.info("ì£¼ë¬¸ ìƒì„±", order_id="123", amount=10000)

# ì»¨í…ìŠ¤íŠ¸ì™€ í•¨ê»˜
with logger.context(request_id="abc"):
    logger.error("ê²°ì œ ì‹¤íŒ¨", error_code="TIMEOUT")
```

#### 3. ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
src/core/logging/
â”œâ”€ __init__.py           # ê³µê°œ API ë…¸ì¶œ
â”œâ”€ logger.py             # Logger í´ë˜ìŠ¤
â”œâ”€ config.py             # ì„¤ì •
â”œâ”€ formatters.py         # JSON/Console í¬ë§·í„°
â”œâ”€ handlers.py           # File/External í•¸ë“¤ëŸ¬
â””â”€ context.py            # Context ê´€ë¦¬
```

#### 4. í•µì‹¬ ì„¤ê³„ ê²°ì •
- **Ref**: ADR-401 (structlog ì‚¬ìš©)
- **íŒ¨í„´**: Singleton Logger Factory
- **ì„±ëŠ¥**: ë¹„ë™ê¸° íŒŒì¼ ì“°ê¸° (aiofiles)

#### 5. ì˜ì¡´ì„±
- External: `structlog==24.1.0`
- External: `aiofiles==23.2.1`
- DNA: Types (LogLevel Enum)

#### 6. í…ŒìŠ¤íŠ¸ ì „ëµ
- ë‹¨ìœ„: ê° í¬ë§·í„°/í•¸ë“¤ëŸ¬ ê²©ë¦¬ í…ŒìŠ¤íŠ¸
- í†µí•©: ì „ì²´ ë¡œê·¸ íŒŒì´í”„ë¼ì¸ E2E í…ŒìŠ¤íŠ¸
- ì»¤ë²„ë¦¬ì§€: 95%+

#### 7. êµ¬í˜„ ìš°ì„ ìˆœìœ„
1. `types.py` (LogLevel Enum) - ê¸°ì´ˆ
2. `config.py` (ì„¤ì •) - ì„¤ì •
3. `formatters.py` (í¬ë§·í„°) - í•µì‹¬
4. `logger.py` (Logger í´ë˜ìŠ¤) - í•µì‹¬
5. `context.py` (Context) - ê³ ê¸‰
6. `handlers.py` (í•¸ë“¤ëŸ¬) - í™•ì¥
```

---

### DNA í•µì‹¬ ì›ì¹™ 3: ê¸°ëŠ¥ë³„ ë¶„í•´ + ì—°ê²°ë¶€ + ì¡°ë¦½

**"ëª¨ë“ˆì´ í¬ë©´ ê¸°ëŠ¥ë³„ë¡œ ë‚˜ëˆ„ê³ , ì—°ê²°ë¶€ ì„¤ê³„ í›„ ì¡°ë¦½"**

#### Stage 4ì—ì„œì˜ ì ìš©

Stage 4ëŠ” "ì²­ì‚¬ì§„ ì„¤ê³„" ë‹¨ê³„ì´ë¯€ë¡œ ì›ì¹™ 3ì€ **ê³„íš ì°¨ì›**ì—ì„œ ì ìš©ë©ë‹ˆë‹¤.

```
DNA ì‹œìŠ¤í…œ í¬ê¸° íŒë‹¨:
â”œâ”€ ì‘ì€ ì‹œìŠ¤í…œ (< 5 íŒŒì¼): í•œ ë²ˆì— ì²­ì‚¬ì§„ ì‘ì„±
â”‚   ì˜ˆ: Types, Config, Error
â”‚
â”œâ”€ ì¤‘ê°„ ì‹œìŠ¤í…œ (5-10 íŒŒì¼): ì²­ì‚¬ì§„ì—ì„œ ëª¨ë“ˆ ëª…ì‹œ
â”‚   ì˜ˆ: Logging, Cache, Testing
â”‚   ì²­ì‚¬ì§„: ëª¨ë“ˆë³„ ì„¹ì…˜ ë¶„ë¦¬
â”‚
â””â”€ í° ì‹œìŠ¤í…œ (10+ íŒŒì¼): ì²­ì‚¬ì§„ì„ ëª¨ë“ˆë³„ë¡œ ë¶„í• 
    ì˜ˆ: Database (Connection + Session + Query + Migration)
    ì²­ì‚¬ì§„: ê° ëª¨ë“ˆë³„ ë³„ë„ ì„¹ì…˜ + ì—°ê²°ë¶€ ëª…ì‹œ
```

#### í° DNA ì‹œìŠ¤í…œ ì²­ì‚¬ì§„ ë¶„í•´ ì „ëµ

```markdown
## ì‚¬ë¡€: DNA Database ì‹œìŠ¤í…œ (í° ì‹œìŠ¤í…œ)

### ì²­ì‚¬ì§„ êµ¬ì¡° (ëª¨ë“ˆë³„ ë¶„í•´)

#### Module 1: Connection Pool
**ì±…ì„**: ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ê´€ë¦¬
**íŒŒì¼**: `connection.py`
**ê³µê°œ API**:
- `get_connection_pool() -> Pool`
- `close_pool()`

#### Module 2: Session Manager
**ì±…ì„**: íŠ¸ëœì­ì…˜ ì„¸ì…˜ ê´€ë¦¬
**íŒŒì¼**: `session.py`
**ê³µê°œ API**:
- `get_session() -> AsyncSession`
- `begin_transaction()`

#### Module 3: Query Builder
**ì±…ì„**: íƒ€ì… ì•ˆì „í•œ ì¿¼ë¦¬ ë¹Œë”
**íŒŒì¼**: `query.py`
**ê³µê°œ API**:
- `select(model: Type[T]) -> Query[T]`
- `insert(model: T) -> None`

#### Module 4: Migration
**ì±…ì„**: ìŠ¤í‚¤ë§ˆ ë²„ì „ ê´€ë¦¬
**íŒŒì¼**: `migration.py`
**ê³µê°œ API**:
- `migrate_up()`
- `migrate_down()`

### ì—°ê²°ë¶€ ì„¤ê³„ (Protocol)

```python
# src/core/database/protocols.py
from typing import Protocol

class ConnectionProvider(Protocol):
    """ì—°ê²° ì œê³µ ì¸í„°í˜ì´ìŠ¤."""
    async def get_connection(self) -> Connection: ...

class SessionProvider(Protocol):
    """ì„¸ì…˜ ì œê³µ ì¸í„°í˜ì´ìŠ¤."""
    async def get_session(self) -> AsyncSession: ...

# Module 1 êµ¬í˜„ â†’ ConnectionProvider
# Module 2 êµ¬í˜„ â†’ SessionProvider
# Module 3ì€ SessionProvider ì˜ì¡´
# Module 4ëŠ” ConnectionProvider ì˜ì¡´
```

### Stage 5 êµ¬í˜„ ê³„íš (ì¡°ë¦½ ì „ëµ)

```
Task 001: Connection Pool êµ¬í˜„
â”œâ”€ connection.py ì‘ì„±
â”œâ”€ ConnectionProvider êµ¬í˜„
â””â”€ í…ŒìŠ¤íŠ¸ (Mock ì—†ìŒ, ì‹¤ì œ Pool)

Task 002: Session Manager êµ¬í˜„
â”œâ”€ session.py ì‘ì„±
â”œâ”€ SessionProvider êµ¬í˜„
â”œâ”€ ConnectionProvider Mock ì‚¬ìš©
â””â”€ í…ŒìŠ¤íŠ¸

Task 003: Query Builder êµ¬í˜„
â”œâ”€ query.py ì‘ì„±
â”œâ”€ SessionProvider Mock ì‚¬ìš©
â””â”€ í…ŒìŠ¤íŠ¸

Task 004: Migration êµ¬í˜„
â”œâ”€ migration.py ì‘ì„±
â”œâ”€ ConnectionProvider Mock ì‚¬ìš©
â””â”€ í…ŒìŠ¤íŠ¸

Task 999: Database í†µí•© (ì¡°ë¦½)
â”œâ”€ ì‹¤ì œ êµ¬í˜„ì²´ë¡œ Mock êµì²´
â”œâ”€ í†µí•© í…ŒìŠ¤íŠ¸ (E2E)
â””â”€ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
```
```

#### ì‘ì€ DNA ì‹œìŠ¤í…œ ì²­ì‚¬ì§„ ì „ëµ

```markdown
## ì‚¬ë¡€: DNA Types ì‹œìŠ¤í…œ (ì‘ì€ ì‹œìŠ¤í…œ)

### ë‹¨ì¼ ì²­ì‚¬ì§„ (ë¶„í•´ ë¶ˆí•„ìš”)

#### ëª©ì 
íƒ€ì… ì•ˆì „ì„± ë³´ì¥ì„ ìœ„í•œ ê³µí†µ íƒ€ì… ì •ì˜

#### ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
src/core/types/
â”œâ”€ __init__.py
â”œâ”€ ids.py        # UserId, OrderId ë“±
â”œâ”€ enums.py      # Status, Level ë“±
â””â”€ models.py     # BaseModel, DTO ë“±
```

#### êµ¬í˜„ ê³„íš (í•œ ë²ˆì—)
Task 001: DNA Types ì „ì²´ êµ¬í˜„
â”œâ”€ ids.py, enums.py, models.py ëª¨ë‘ ì‘ì„±
â”œâ”€ í…ŒìŠ¤íŠ¸ ì „ì²´
â””â”€ ì™„ë£Œ (ë¶„í•´ ë¶ˆí•„ìš”)
```

---

### DNA í•µì‹¬ ì›ì¹™ 4: ì—­ë°©í–¥ ìˆ˜ì • í”„ë¡œí† ì½œ

**"ì•ì„  ê²°ì •ì˜ ì˜¤ë¥˜ ë°œê²¬ ì‹œ â†’ ë˜ëŒì•„ê°€ì„œ ìˆ˜ì • â†’ ë‹¤ì‹œ í˜„ì¬ê¹Œì§€ ì§„í–‰"**

#### Stage 4ì—ì„œ ì—­ë°©í–¥ ìˆ˜ì •ì´ ë°œìƒí•˜ëŠ” ê²½ìš°

```
ì‹œë‚˜ë¦¬ì˜¤ 1: Stage 3 ADR ì˜¤ë¥˜ ë°œê²¬
â”œâ”€ Stage 4 ì²­ì‚¬ì§„ ì‘ì„± ì¤‘
â”œâ”€ ADR-401 (structlog ì‚¬ìš©) ì œì•½ ë°œê²¬
â”‚   ì˜ˆ: structlogì´ Windowsì—ì„œ ë¬¸ì œ ë°œê²¬
â”œâ”€ â†’ Stage 3ë¡œ ëŒì•„ê°€ ADR-401 ìˆ˜ì •
â”œâ”€ â†’ Stage 4 ì²­ì‚¬ì§„ ì¬ì‘ì„±
â””â”€ â†’ ì¶”ì ì„± ì—…ë°ì´íŠ¸

ì‹œë‚˜ë¦¬ì˜¤ 2: Stage 5ì—ì„œ ì²­ì‚¬ì§„ ë¶ˆì™„ì „ ë°œê²¬
â”œâ”€ Stage 5 Logging êµ¬í˜„ ì¤‘
â”œâ”€ ì²­ì‚¬ì§„ì— ë¹„ë™ê¸° ë¡œê·¸ ì“°ê¸° ëˆ„ë½ ë°œê²¬
â”œâ”€ â†’ Stage 4ë¡œ ëŒì•„ê°€ ì²­ì‚¬ì§„ ë³´ì™„
â”œâ”€ â†’ Stage 5 êµ¬í˜„ ì¬ì§„í–‰
â””â”€ â†’ ì¶”ì ì„± ì—…ë°ì´íŠ¸
```

#### 6ë‹¨ê³„ ìˆ˜ì • í”„ë¡œí† ì½œ

```markdown
## ì‹¤ì œ ì‚¬ë¡€: DNA Database ì²­ì‚¬ì§„ ìˆ˜ì •

### Step 1: ì˜¤ë¥˜ ë°œê²¬ ë° ë¬¸ì„œí™”
**ë°œê²¬ ì‹œì **: Stage 4 (Database ì²­ì‚¬ì§„ ì‘ì„± ì¤‘)
**íŒŒì¼**: `04D-02_dna_database_blueprint.md`
**ë¬¸ì œ**: ADR-402ì—ì„œ "PostgreSQL 13+"ì¸ë°, ì²­ì‚¬ì§„ì— "MySQL" ì–¸ê¸‰

### Step 2: ì˜í–¥ ë²”ìœ„ íŒŒì•…
**ì˜í–¥ë°›ëŠ” ë¬¸ì„œ**:
- Stage 3: `03A-402_database_selection.md` (í™•ì¸ í•„ìš”)
- Stage 4: `04D-02_dna_database_blueprint.md` (í˜„ì¬)

**ì˜í–¥ë°›ëŠ” êµ¬í˜„**: ì—†ìŒ (ì•„ì§ êµ¬í˜„ ì „)

### Step 3: í•´ë‹¹ Stageë¡œ ì´ë™ ë° ìˆ˜ì •
```bash
# Stage 3 ADR ì¬í™•ì¸
$ cat 03A-402_database_selection.md
  â†’ "PostgreSQL 13+" ë§ìŒ

# Stage 4 ì²­ì‚¬ì§„ ìˆ˜ì •
$ edit 04D-02_dna_database_blueprint.md
  Line 45: MySQL â†’ PostgreSQLë¡œ ìˆ˜ì •
  Line 67: MySQL ì „ìš© ê¸°ëŠ¥ ì œê±°
  Line 89: PostgreSQL ì „ìš© ê¸°ëŠ¥ ì¶”ê°€ (JSONB, Full-text search)
```

### Step 4: ì¤‘ê°„ Stage ì „íŒŒ
Stage 5 ì•„ì§ ì‹œì‘ ì•ˆ í•¨ â†’ ì „íŒŒ ë¶ˆí•„ìš”

### Step 5: í˜„ì¬ Stage ì¬ì§„í–‰
```bash
# Stage 4 ì²­ì‚¬ì§„ ì¬ê²€í† 
$ review 04D-02_dna_database_blueprint.md
  - PostgreSQL ì „ìš© ê¸°ëŠ¥ ë°˜ì˜ í™•ì¸
  - ADR-402 ì°¸ì¡° ì—…ë°ì´íŠ¸
  - ì˜ì¡´ì„±ì— psycopg3 ì¶”ê°€
```

### Step 6: ì¬ì§„í–‰ ê²°ê³¼ ê²€ì¦
**ê²€ì¦ í•­ëª©**:
- [ ] ADR-402 "PostgreSQL 13+" í™•ì¸
- [ ] ì²­ì‚¬ì§„ 7ê°œ ì„¹ì…˜ ì™„ì „
- [ ] MySQL ì–¸ê¸‰ ëª¨ë‘ ì œê±°
- [ ] PostgreSQL ì „ìš© ê¸°ëŠ¥ ì¶”ê°€
- [ ] ì¶”ì ì„± ëª…ì‹œ (Ref: ADR-402)
```

#### ì¶”ì ì„± (Traceability) ìœ ì§€

**ëª¨ë“  ìˆ˜ì •ì€ ëª…ì‹œì ìœ¼ë¡œ ì°¸ì¡°**:

```markdown
## Stage 3 ADR (03A-402_database_selection.md)
**ê²°ì •**: PostgreSQL 13+ ì‚¬ìš©
**ë‚ ì§œ**: 2024-11-10

## Stage 4 ì²­ì‚¬ì§„ (04D-02_dna_database_blueprint.md)
Line 1: # DNA Database ì‹œìŠ¤í…œ ì²­ì‚¬ì§„
Line 2: # Ref: ADR-402 (PostgreSQL 13+)
Line 3:
Line 4: > **History**:
Line 5: > - v1.0 (2024-11-10): ì´ˆê¸° ì‘ì„±
Line 6: > - v1.1 (2024-11-11): MySQL â†’ PostgreSQL ìˆ˜ì • (ADR ë¶ˆì¼ì¹˜ ë°œê²¬)

Line 45: ## ë°ì´í„°ë² ì´ìŠ¤ ì—”ì§„
Line 46: **ì„ íƒ**: PostgreSQL 13+
Line 47: **Ref**: ADR-402 (Line 23-45)
Line 48: **ì „ìš© ê¸°ëŠ¥**:
Line 49: - JSONB íƒ€ì…
Line 50: - Full-text search
Line 51: - Row-level security

## Stage 5 êµ¬í˜„ (src/core/database/)
Line 1: # Ref: 04D-02_dna_database_blueprint.md
Line 2: # Updated: 2024-11-11 (PostgreSQL ì „ìš© ê¸°ëŠ¥ ë°˜ì˜)
```

---

## ğŸ¯ DNA ì›ì¹™ ì ìš© ìš”ì•½ (Stage 4)

| ì›ì¹™ | Stage 4 ì ìš© ë°©ë²• | ì²´í¬í¬ì¸íŠ¸ |
|------|------------------|-----------|
| **1. AI ìµœì  í¬ê¸°** | ì‹œìŠ¤í…œ ìœ í˜•ë³„ ì„¸ì…˜ ë¶„ë¦¬ (2-3ê°œ/ì„¸ì…˜) | ì„¸ì…˜ë‹¹ 80-90K í† í° |
| **2. ì™„ì „í•´ì§ˆ ë•Œê¹Œì§€** | 7ê°œ ì„¹ì…˜ ì™„ì „ì„±, 4ë‹¨ê³„ ê²€ì¦ | ëª¨ë“  ì²­ì‚¬ì§„ 7 sections |
| **3. ê¸°ëŠ¥ë³„ ë¶„í•´** | í° ì‹œìŠ¤í…œì€ ëª¨ë“ˆë³„ ë¶„í•´ + Protocol | Protocol + Mock + ì¡°ë¦½ |
| **4. ì—­ë°©í–¥ ìˆ˜ì •** | 6ë‹¨ê³„ í”„ë¡œí† ì½œ, ì¶”ì ì„± ìœ ì§€ | History/Ref ëª…ì‹œ |

---

## ğŸ¤” ì™œ DNA ì‹œìŠ¤í…œ ì²­ì‚¬ì§„ì´ í•„ìš”í•œê°€?

### Bridgeì˜ ì˜ë¯¸: "Gapì´ ì•„ë‹ˆë¼ ë‹¤ë¦¬"

```
ê¸°ì¡´ ì˜¤í•´:
â”œâ”€ Stage 3 (ADR) ì™„ë£Œ
â”œâ”€ ???
â”œâ”€ ???
â”œâ”€ ???
â””â”€ Stage 7 (Blueprint) ì‹œì‘

â†’ "Stage 4-6ì€ ë­í•˜ëŠ” ê±°ì§€? ê·¸ëƒ¥ ë„˜ì–´ê°€ë„ ë˜ë‚˜?"

ì‹¤ì œ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stage 4-6 = Bridge (ë‹¤ë¦¬)                               â”‚
â”‚                                                         â”‚
â”‚ ADR (ê²°ì •) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Blueprint (ì„¤ê³„)     â”‚
â”‚             â†‘                   â†‘                       â”‚
â”‚             â”‚    Stage 4-6     â”‚                       â”‚
â”‚             â”‚                   â”‚                       â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                         â”‚
â”‚ ê²°ì •ì„ "ì‹¤í–‰ ê°€ëŠ¥í•œ í™˜ê²½"ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ë‹¨ê³„             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë¹„ìœ : ì§‘ ì§“ê¸°

```
ADR = "ì„œìš¸ì—ì„œ ë¶€ì‚° ê°€ê¸°ë¡œ ê²°ì •" (ê²°ì •)
Bridge = "KTX í‹°ì¼“ êµ¬ë§¤, ì—­ ë„ì°©" (ì¤€ë¹„)
Blueprint = "ì¶œë°œì—­, í™˜ìŠ¹, ë„ì°©ì—­ ê³„íš" (ìƒì„¸ ê³„íš)

ADR = "ì½˜í¬ë¦¬íŠ¸ ê¸°ì´ˆë¡œ ê²°ì •" (ê²°ì •)
Bridge = "ì½˜í¬ë¦¬íŠ¸ ë°°í•©, ê±°í‘¸ì§‘ ì¤€ë¹„" (í™˜ê²½ êµ¬ì¶•)
Blueprint = "ê° ë°©ì˜ ê¸°ì´ˆ ìœ„ì¹˜ì™€ í¬ê¸°" (ìƒì„¸ ì„¤ê³„)
```

### DNA ì‹œìŠ¤í…œ = í™˜ê²½/í”Œë«í¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ë„ë©”ì¸ ì½”ë“œ                          â”‚
â”‚  (Stage 7-9ì—ì„œ êµ¬í˜„)                                   â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ ì£¼ë¬¸    â”‚ â”‚ ê³„ì¢Œ    â”‚ â”‚ ì‹œì„¸    â”‚  â† ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§  â”‚
â”‚  â”‚ ì„œë¹„ìŠ¤  â”‚ â”‚ ì„œë¹„ìŠ¤  â”‚ â”‚ ì„œë¹„ìŠ¤  â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                   â”‚
â”‚       â”‚          â”‚          â”‚                          â”‚
â”‚  â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚       â”‚          â”‚          â”‚                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚        DNA ì‹œìŠ¤í…œ (í™˜ê²½)       â”‚                     â”‚
â”‚  â”‚  (Stage 4-6ì—ì„œ êµ¬ì¶•)          â”‚                     â”‚
â”‚  â”‚                                â”‚                     â”‚
â”‚  â”‚  logging / config / types     â”‚                     â”‚
â”‚  â”‚  database / cache / messaging â”‚                     â”‚
â”‚  â”‚  testing / monitoring / auth  â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

í•µì‹¬:
â”œâ”€ DNAê°€ ë¨¼ì € êµ¬ì¶•ë˜ì–´ì•¼ ë„ë©”ì¸ì´ ì¼ê´€ë˜ê²Œ êµ¬í˜„ë¨
â”œâ”€ ë„ë©”ì¸ì€ DNAë¥¼ "ì‚¬ìš©"ë§Œ í•¨ (ì§ì ‘ êµ¬í˜„ X)
â””â”€ DNA ë³€ê²½ = ì „ì²´ ì˜í–¥ (ì‹ ì¤‘í•´ì•¼)
```

---

## ğŸ“¥ ì…ë ¥ ë¬¸ì„œ

### Stage 3ì—ì„œ ì „ë‹¬ë°›ëŠ” ê²ƒ

| íŒŒì¼ | í•µì‹¬ ë‚´ìš© | ì´ Stageì—ì„œ ì‚¬ìš© |
|------|----------|-----------------|
| `03A-401~499_*.md` | DNA ì‹œìŠ¤í…œ ADR | ê° ì‹œìŠ¤í…œ ì„¤ê³„ ê·¼ê±° |
| `03A-201~299_*.md` | ê¸°ìˆ  ìŠ¤íƒ ADR | êµ¬í˜„ ê¸°ìˆ  ì„ íƒ |
| `03A-000_adr_index.md` | ADR ëª©ë¡ | ì „ì²´ ê²°ì • ì°¸ì¡° |

---

## ğŸ“¤ ì¶œë ¥ ë¬¸ì„œ

### í•„ìˆ˜ ì‚°ì¶œë¬¼

```
docs/
â”œâ”€â”€ 04B-01_dna_blueprint.md        # DNA ì‹œìŠ¤í…œ ì²­ì‚¬ì§„ (í†µí•©)
â””â”€â”€ 04B-02_dna_directory.md        # ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„¸

ë˜ëŠ” ì‹œìŠ¤í…œë³„ ë¶„ë¦¬:
docs/dna-blueprint/
â”œâ”€â”€ 04B-00_overview.md             # ì „ì²´ ê°œìš”
â”œâ”€â”€ 04B-01_logging.md              # ë¡œê¹… ì‹œìŠ¤í…œ
â”œâ”€â”€ 04B-02_config.md               # ì„¤ì • ì‹œìŠ¤í…œ
â”œâ”€â”€ 04B-03_types.md                # íƒ€ì… ì‹œìŠ¤í…œ
â”œâ”€â”€ 04B-04_errors.md               # ì—ëŸ¬ ì²˜ë¦¬
â”œâ”€â”€ 04B-05_database.md             # ë°ì´í„°ë² ì´ìŠ¤
â”œâ”€â”€ 04B-06_cache.md                # ìºì‹œ
â”œâ”€â”€ 04B-07_messaging.md            # ë©”ì‹œì§•
â”œâ”€â”€ 04B-08_testing.md              # í…ŒìŠ¤íŒ…
â”œâ”€â”€ 04B-09_monitoring.md           # ëª¨ë‹ˆí„°ë§
â”œâ”€â”€ 04B-10_security.md             # ë³´ì•ˆ
â””â”€â”€ 04B-11_api_gateway.md          # API ê²Œì´íŠ¸ì›¨ì´
```

---


## ğŸ§¬ DNA 11ê°œ ì‹œìŠ¤í…œ

### ì‹œìŠ¤í…œ ê°œìš”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  DNA 11ê°œ ì‹œìŠ¤í…œ                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  í•µì‹¬ ì¸í”„ë¼ (4ê°œ):                                      â”‚
â”‚  â”œâ”€ 1. Logging (structlog): êµ¬ì¡°í™”ëœ ë¡œê¹…               â”‚
â”‚  â”œâ”€ 2. Configuration (Pydantic): íƒ€ì… ì•ˆì „ ì„¤ì •         â”‚
â”‚  â”œâ”€ 3. Types (Pydantic v2): ê³µí†µ íƒ€ì… ì •ì˜              â”‚
â”‚  â””â”€ 4. Error Handling: ì˜ˆì™¸ ê³„ì¸µ + ì—ëŸ¬ ì½”ë“œ            â”‚
â”‚                                                          â”‚
â”‚  ë°ì´í„°/í†µì‹  (3ê°œ):                                      â”‚
â”‚  â”œâ”€ 5. Database (SQLAlchemy): ORM + ë§ˆì´ê·¸ë ˆì´ì…˜        â”‚
â”‚  â”œâ”€ 6. Cache (Redis): ìºì‹± ì¶”ìƒí™”                       â”‚
â”‚  â””â”€ 7. Messaging (Kafka/Redis): ì´ë²¤íŠ¸ ë°œí–‰/êµ¬ë…        â”‚
â”‚                                                          â”‚
â”‚  í’ˆì§ˆ/ë³´ì•ˆ (4ê°œ):                                        â”‚
â”‚  â”œâ”€ 8. Testing (pytest): í…ŒìŠ¤íŠ¸ ì¸í”„ë¼                  â”‚
â”‚  â”œâ”€ 9. Monitoring (Prometheus): ë©”íŠ¸ë¦­ ìˆ˜ì§‘             â”‚
â”‚  â”œâ”€ 10. Security: ì¸ì¦/ì¸ê°€                             â”‚
â”‚  â””â”€ 11. API Gateway: ë¼ìš°íŒ…/ë¯¸ë“¤ì›¨ì–´                    â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì‹œìŠ¤í…œë³„ ìƒì„¸

| # | ì‹œìŠ¤í…œ | í‘œì¤€ ë„êµ¬ | í•µì‹¬ ê¸°ëŠ¥ | ë””ë ‰í† ë¦¬ |
|---|--------|----------|----------|----------|
| 1 | Logging | structlog | JSON ë¡œê¹…, trace_id | `core/logging/` |
| 2 | Configuration | pydantic-settings | í™˜ê²½ ë³€ìˆ˜, íƒ€ì… ì•ˆì „ | `core/config/` |
| 3 | Types | Pydantic v2 | ê³µí†µ íƒ€ì…, ID íƒ€ì… | `core/types/` |
| 4 | Error Handling | custom | ì˜ˆì™¸ ê³„ì¸µ, ì—ëŸ¬ ì½”ë“œ | `core/errors/` |
| 5 | Database | SQLAlchemy 2.0 | ì„¸ì…˜ ê´€ë¦¬, ë§ˆì´ê·¸ë ˆì´ì…˜ | `core/database/` |
| 6 | Cache | Redis | ìºì‹œ ì¶”ìƒí™”, @cached | `core/cache/` |
| 7 | Messaging | Kafka/Redis Streams | Pub/Sub, ì´ë²¤íŠ¸ | `core/messaging/` |
| 8 | Testing | pytest | fixture, ì»¤ë²„ë¦¬ì§€ | `tests/` |
| 9 | Monitoring | Prometheus | ë©”íŠ¸ë¦­, ì•Œë¦¼ | `core/monitoring/` |
| 10 | Security | JWT + OAuth2 | ì¸ì¦, ì¸ê°€ | `core/security/` |
| 11 | API Gateway | FastAPI | ë¼ìš°íŒ…, ë¯¸ë“¤ì›¨ì–´ | `api/` |

---

## ğŸ¯ íŒ¨ë°€ë¦¬ë³„ DNA ì‹œìŠ¤í…œ ì„ íƒ

### ëª¨ë“  íŒ¨ë°€ë¦¬ ê³µí†µ (í•„ìˆ˜)

```
í•­ìƒ í•„ìš”:
â”œâ”€ 1. Logging (ë¡œê·¸ ì—†ì´ ë””ë²„ê¹… ë¶ˆê°€)
â”œâ”€ 2. Configuration (ì„¤ì • í•˜ë“œì½”ë”© ê¸ˆì§€)
â”œâ”€ 3. Types (íƒ€ì… ì•ˆì „ì„± í•„ìˆ˜)
â”œâ”€ 4. Error Handling (ì—ëŸ¬ ì²˜ë¦¬ í‘œì¤€í™”)
â””â”€ 8. Testing (í…ŒìŠ¤íŠ¸ ì—†ì´ ë°°í¬ ë¶ˆê°€)
```

### íŒ¨ë°€ë¦¬ë³„ ì„ íƒ ê°€ì´ë“œ

| DNA ì‹œìŠ¤í…œ | A-A-B (CRUD) | B-C-A (ìŠ¤íŠ¸ë¦¬ë°) | B-A-A (í˜‘ì—…) | B-B-B (ê²€ìƒ‰) |
|-----------|-------------|----------------|-------------|-------------|
| 5. Database | âœ… í•„ìˆ˜ | âš ï¸ ì„ íƒ | âœ… í•„ìˆ˜ | âš ï¸ ì„ íƒ |
| 6. Cache | âœ… ê¶Œì¥ | âœ… í•„ìˆ˜ | âœ… í•„ìˆ˜ | âœ… í•„ìˆ˜ |
| 7. Messaging | âš ï¸ ì„ íƒ | âœ… í•„ìˆ˜ | âœ… í•„ìˆ˜ | âš ï¸ ì„ íƒ |
| 9. Monitoring | âœ… ê¶Œì¥ | âœ… í•„ìˆ˜ | âœ… ê¶Œì¥ | âœ… ê¶Œì¥ |
| 10. Security | âœ… í•„ìˆ˜ | âš ï¸ ì„ íƒ | âœ… í•„ìˆ˜ | âš ï¸ ì„ íƒ |
| 11. API Gateway | âœ… í•„ìˆ˜ | âœ… í•„ìˆ˜ | âœ… í•„ìˆ˜ | âœ… í•„ìˆ˜ |

**ë²”ë¡€**: âœ… í•„ìˆ˜ / âš ï¸ í”„ë¡œì íŠ¸ì— ë”°ë¼ ì„ íƒ

### íŒ¨ë°€ë¦¬ë³„ íŠ¹í™” ì„¤ì •

**A-A-B (CRUD/íŠ¸ëœì­ì…˜)** - ì˜ˆ: ì£¼ì‹ ê±°ë˜ í”Œë«í¼
```
í•„ìˆ˜: ì „ì²´ 11ê°œ (ê¸ˆìœµ ì„œë¹„ìŠ¤ íŠ¹ì„±)
â”œâ”€ Database: ACID íŠ¸ëœì­ì…˜ í•„ìˆ˜
â”œâ”€ Cache: ì½ê¸° ìµœì í™”
â”œâ”€ Security: í•„ìˆ˜ (ê¸ˆìœµ ê·œì œ)
â””â”€ Monitoring: í•„ìˆ˜ (ê°ì‚¬ ì¶”ì )
```

**B-C-A (ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°)** - ì˜ˆ: IoT ì„¼ì„œ ë°ì´í„°
```
í•„ìˆ˜: 9ê°œ (Database, Security ì„ íƒ)
â”œâ”€ Messaging: í•µì‹¬ (Kafka)
â”œâ”€ Cache: ë²„í¼ë§ í•„ìˆ˜
â”œâ”€ Monitoring: ì§€ì—° ëª¨ë‹ˆí„°ë§ í•„ìˆ˜
â””â”€ API Gateway: WebSocket ì§€ì›
```

**B-A-A (í˜‘ì—…/ë™ê¸°í™”)** - ì˜ˆ: ì‹¤ì‹œê°„ ë¬¸ì„œ í¸ì§‘
```
í•„ìˆ˜: 10ê°œ (Messaging í¬í•¨)
â”œâ”€ Database: ìƒíƒœ ì €ì¥ í•„ìˆ˜
â”œâ”€ Cache: ë¡œì»¬ ìºì‹œ í•„ìˆ˜
â”œâ”€ Messaging: ì‹¤ì‹œê°„ ë™ê¸°í™” (WebSocket)
â””â”€ Security: ì‚¬ìš©ì ì¸ì¦ í•„ìˆ˜
```

---


## ğŸ“‹ ì²­ì‚¬ì§„ ì‘ì„± ë°©ë²•

### Part 1: ì‹œìŠ¤í…œ ì„ íƒ ê²°ì •

```
Step 1: íŒ¨ë°€ë¦¬ í™•ì¸
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
01C-01_family.mdì—ì„œ íŒ¨ë°€ë¦¬ í™•ì¸
â†’ A-A-B (CRUD/íŠ¸ëœì­ì…˜)

Step 2: í•„ìˆ˜/ì„ íƒ ì‹œìŠ¤í…œ ê²°ì •
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
í•„ìˆ˜ (ê³µí†µ 5ê°œ):
- Logging, Config, Types, Error, Testing

í•„ìˆ˜ (íŒ¨ë°€ë¦¬ë³„):
- Database (A-A-Bì´ë¯€ë¡œ)
- Security (ê¸ˆìœµì´ë¯€ë¡œ)
- API Gateway (ì›¹ ì„œë¹„ìŠ¤ì´ë¯€ë¡œ)

ì„ íƒ:
- Cache (ì½ê¸° ìµœì í™” ì›í•¨ â†’ í¬í•¨)
- Monitoring (ìš´ì˜ í•„ìˆ˜ â†’ í¬í•¨)
- Messaging (MVP ì´í›„ â†’ ì œì™¸)

Step 3: ADR í™•ì¸
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
03A-401: ë¡œê¹… â†’ structlog
03A-402: ì—ëŸ¬ ì²˜ë¦¬ â†’ ì˜ˆì™¸ ê³„ì¸µ
03A-201: DB â†’ PostgreSQL
03A-204: ìºì‹œ â†’ Redis
```

---

### Part 2: ë””ë ‰í† ë¦¬ êµ¬ì¡° ì„¤ê³„

```
Step 1: ê¸°ë³¸ êµ¬ì¡° ê²°ì •
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
src/
â”œâ”€â”€ core/                  # DNA ì‹œìŠ¤í…œ
â”œâ”€â”€ domain/                # ë„ë©”ì¸ ë¡œì§ (Stage 7-9)
â””â”€â”€ api/                   # API ë ˆì´ì–´ (Stage 7-9)

tests/
â”œâ”€â”€ unit/                  # ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ integration/           # í†µí•© í…ŒìŠ¤íŠ¸
â””â”€â”€ conftest.py           # ê³µí†µ fixture

Step 2: core/ ìƒì„¸ êµ¬ì¡°
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
src/core/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ logging/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ logger.py          # structlog ë˜í¼
â”‚   â””â”€â”€ config.py          # ë¡œê·¸ ì„¤ì •
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ settings.py        # Pydantic Settings
â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py            # BaseModel í™•ì¥
â”‚   â””â”€â”€ ids.py             # ID íƒ€ì…
â”œâ”€â”€ errors/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ exceptions.py      # ì˜ˆì™¸ ê³„ì¸µ
â”‚   â””â”€â”€ codes.py           # ì—ëŸ¬ ì½”ë“œ
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ session.py         # ì„¸ì…˜ ê´€ë¦¬
â”‚   â””â”€â”€ base.py            # Base ëª¨ë¸
â”œâ”€â”€ cache/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ client.py          # Redis í´ë¼ì´ì–¸íŠ¸
â”‚   â””â”€â”€ decorators.py      # @cached
â””â”€â”€ security/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ auth.py            # ì¸ì¦
    â””â”€â”€ jwt.py             # JWT ì²˜ë¦¬
```

---

### Part 3: ì¸í„°í˜ì´ìŠ¤ ì„¤ê³„

ê° DNA ì‹œìŠ¤í…œì˜ **ê³µê°œ API**ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

```python
# 1. Logging
from core.logging import get_logger
logger = get_logger(__name__)
logger.info("message", user_id=123, trace_id="abc")

# 2. Configuration
from core.config import settings
db_url = settings.database_url
redis_url = settings.redis_url

# 3. Types
from core.types import UserId, OrderId
user_id: UserId = UserId("uuid-string")

# 4. Error Handling
from core.errors import NotFoundError, ValidationError
raise NotFoundError(entity="User", id=user_id)

# 5. Database
from core.database import get_session
async with get_session() as session:
    result = await session.execute(query)

# 6. Cache
from core.cache import cached, cache_client
@cached(ttl=60)
async def get_user(user_id: str): ...

# 10. Security
from core.security import get_current_user, require_role
@require_role("admin")
async def admin_endpoint(user = Depends(get_current_user)): ...
```

---

### Part 4: êµ¬í˜„ ìˆœì„œ ê²°ì •

ì˜ì¡´ì„± ê¸°ë°˜ìœ¼ë¡œ êµ¬í˜„ ìˆœì„œë¥¼ ê²°ì •í•©ë‹ˆë‹¤.

```
ì˜ì¡´ì„± ê·¸ë˜í”„:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Types (ì˜ì¡´ì„± ì—†ìŒ)
   â†“
Config (Types ì˜ì¡´)
   â†“
Logging (Config, Types ì˜ì¡´)
   â†“
Error (Types, Logging ì˜ì¡´)
   â†“
Database (Config, Types, Error ì˜ì¡´)
   â†“
Cache (Config, Types, Error ì˜ì¡´)
   â†“
Security (Config, Types, Error, Database ì˜ì¡´)
   â†“
Testing (ì „ì²´ ì˜ì¡´)
   â†“
Monitoring (Logging, Config ì˜ì¡´)
   â†“
API Gateway (ì „ì²´ ì˜ì¡´)

ê¶Œì¥ êµ¬í˜„ ìˆœì„œ:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Types      â†’ ì˜ì¡´ì„± ì—†ìŒ, ë¨¼ì € êµ¬í˜„
2. Config     â†’ Typesë§Œ ì˜ì¡´
3. Logging    â†’ Config, Types ì˜ì¡´
4. Error      â†’ Types, Logging ì˜ì¡´
5. Testing    â†’ ìœ„ 4ê°œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•´ì•¼
6. Database   â†’ ìœ„ 4ê°œ + Testing
7. Cache      â†’ ìœ„ 4ê°œ + Testing
8. Security   â†’ ìœ„ ì „ì²´
9. Monitoring â†’ Logging, Config
10. API GW    â†’ ì „ì²´ í†µí•©
```

---


## ğŸ“‹ ì²­ì‚¬ì§„ í…œí”Œë¦¿

### 04B-01_dna_blueprint.md í…œí”Œë¦¿

```markdown
# DNA ì‹œìŠ¤í…œ ì²­ì‚¬ì§„

**í”„ë¡œì íŠ¸**: [í”„ë¡œì íŠ¸ëª…]
**íŒ¨ë°€ë¦¬**: [íŒ¨ë°€ë¦¬ ì½”ë“œ] ([íŒ¨ë°€ë¦¬ëª…])
**ì‘ì„±ì¼**: YYYY-MM-DD

---

## 1. ì„ íƒëœ DNA ì‹œìŠ¤í…œ

### 1.1 í•„ìˆ˜ ì‹œìŠ¤í…œ (ê³µí†µ)

| # | ì‹œìŠ¤í…œ | ë„êµ¬ | ADR |
|---|--------|------|-----|
| 1 | Logging | structlog | ADR-401 |
| 2 | Configuration | pydantic-settings | ADR-402 |
| 3 | Types | Pydantic v2 | ADR-403 |
| 4 | Error Handling | custom | ADR-404 |
| 8 | Testing | pytest | ADR-405 |

### 1.2 í•„ìˆ˜ ì‹œìŠ¤í…œ (íŒ¨ë°€ë¦¬)

| # | ì‹œìŠ¤í…œ | ë„êµ¬ | ADR | ì„ íƒ ê·¼ê±° |
|---|--------|------|-----|----------|
| 5 | Database | PostgreSQL + SQLAlchemy | ADR-201 | ACID í•„ìš” |
| 10 | Security | JWT + RS256 | ADR-406 | ì¸ì¦ í•„ìˆ˜ |
| 11 | API Gateway | FastAPI | ADR-202 | ë¹„ë™ê¸° ì§€ì› |

### 1.3 ì„ íƒ ì‹œìŠ¤í…œ

| # | ì‹œìŠ¤í…œ | ë„êµ¬ | ADR | ì„ íƒ ê·¼ê±° |
|---|--------|------|-----|----------|
| 6 | Cache | Redis | ADR-204 | ì½ê¸° ìµœì í™” |
| 9 | Monitoring | Prometheus | ADR-407 | ìš´ì˜ í•„ìˆ˜ |

### 1.4 ì œì™¸ ì‹œìŠ¤í…œ

| # | ì‹œìŠ¤í…œ | ì œì™¸ ê·¼ê±° | ì¶”ê°€ ì‹œì  |
|---|--------|----------|----------|
| 7 | Messaging | MVP ë²”ìœ„ ì™¸ | Phase 2 |

---

## 2. ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
src/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ logging/
â”‚   â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ errors/
â”‚   â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ cache/
â”‚   â””â”€â”€ security/
â”œâ”€â”€ domain/
â””â”€â”€ api/

tests/
â”œâ”€â”€ unit/
â”œâ”€â”€ integration/
â””â”€â”€ conftest.py
```

---

## 3. ê° ì‹œìŠ¤í…œ ìƒì„¸

### 3.1 Logging

**ë””ë ‰í† ë¦¬**: `src/core/logging/`

**íŒŒì¼ êµ¬ì„±**:
- `__init__.py`: ê³µê°œ API export
- `logger.py`: structlog ë˜í¼
- `config.py`: ë¡œê·¸ ë ˆë²¨, í¬ë§· ì„¤ì •

**ê³µê°œ API**:
```python
from core.logging import get_logger, configure_logging

logger = get_logger(__name__)
logger.info("message", key=value)
```

**ì„¤ì •**:
- ê°œë°œ: Console, ì»¬ëŸ¬ ì¶œë ¥
- ìš´ì˜: JSON, íŒŒì¼ + stdout

---

### 3.2 Configuration

**ë””ë ‰í† ë¦¬**: `src/core/config/`

**íŒŒì¼ êµ¬ì„±**:
- `__init__.py`: settings export
- `settings.py`: Pydantic Settings í´ë˜ìŠ¤

**ê³µê°œ API**:
```python
from core.config import settings

settings.database_url
settings.redis_url
settings.jwt_secret
```

**í™˜ê²½ ë³€ìˆ˜**:
- `DATABASE_URL`
- `REDIS_URL`
- `JWT_SECRET`
- `LOG_LEVEL`

---

[... ê° ì‹œìŠ¤í…œë³„ ë™ì¼ í˜•ì‹ ...]

---

## 4. êµ¬í˜„ ìˆœì„œ

| ìˆœì„œ | ì‹œìŠ¤í…œ | ì˜ì¡´ì„± | ì˜ˆìƒ ì‹œê°„ |
|------|--------|-------|----------|
| 1 | Types | ì—†ìŒ | 2ì‹œê°„ |
| 2 | Config | Types | 2ì‹œê°„ |
| 3 | Logging | Config, Types | 3ì‹œê°„ |
| 4 | Error | Types, Logging | 3ì‹œê°„ |
| 5 | Testing | ìœ„ 4ê°œ | 4ì‹œê°„ |
| 6 | Database | ìœ„ 5ê°œ | 4ì‹œê°„ |
| 7 | Cache | ìœ„ 5ê°œ | 3ì‹œê°„ |
| 8 | Security | ìœ„ ì „ì²´ | 4ì‹œê°„ |
| 9 | Monitoring | Logging, Config | 3ì‹œê°„ |
| 10 | API Gateway | ì „ì²´ | 4ì‹œê°„ |

**ì´ ì˜ˆìƒ ì‹œê°„**: 32ì‹œê°„ (ì•½ 4ì¼)

---

## 5. ì˜ì¡´ì„± ê·¸ë˜í”„

```
Types
   â†“
Config â† Logging
   â†“        â†“
Error â†â”€â”€â”€â”€â”˜
   â†“
Database â† Cache
   â†“
Security
   â†“
Testing â†’ Monitoring â†’ API Gateway
```

---

## 6. Stage 5 ì „ë‹¬ ì‚¬í•­

- [ ] ê° ì‹œìŠ¤í…œë³„ ìƒì„¸ ì„¤ê³„ ì™„ë£Œ
- [ ] ê³µê°œ API ì •ì˜ ì™„ë£Œ
- [ ] êµ¬í˜„ ìˆœì„œ ê²°ì • ì™„ë£Œ
- [ ] ì˜ˆìƒ ì‹œê°„ ì‚°ì • ì™„ë£Œ
```

---


## ğŸ“ ì²­ì‚¬ì§„ ì‘ì„± ì˜ˆì‹œ (ì£¼ì‹ ê±°ë˜ í”Œë«í¼)

### ì˜ˆì‹œ: Logging ì‹œìŠ¤í…œ ì²­ì‚¬ì§„

```markdown
### 3.1 Logging ì‹œìŠ¤í…œ

**ADR ì°¸ì¡°**: ADR-401 (ë¡œê¹… í‘œì¤€í™”)

**ë””ë ‰í† ë¦¬**: `src/core/logging/`

**íŒŒì¼ êµ¬ì„±**:
```
src/core/logging/
â”œâ”€â”€ __init__.py          # get_logger, configure_logging export
â”œâ”€â”€ logger.py            # structlog ë˜í¼
â”œâ”€â”€ config.py            # ë¡œê·¸ ì„¤ì • (ë ˆë²¨, í¬ë§·)
â””â”€â”€ processors.py        # ì»¤ìŠ¤í…€ í”„ë¡œì„¸ì„œ (trace_id ì£¼ì…)
```

**ê³µê°œ API**:
```python
# ê¸°ë³¸ ì‚¬ìš©
from core.logging import get_logger
logger = get_logger(__name__)

# ì¼ë°˜ ë¡œê¹…
logger.info("ì£¼ë¬¸ ìƒì„±", order_id="ORD-123", user_id="USR-456")

# ì—ëŸ¬ ë¡œê¹… (ìë™ ìŠ¤íƒíŠ¸ë ˆì´ìŠ¤)
try:
    process_order()
except Exception as e:
    logger.exception("ì£¼ë¬¸ ì²˜ë¦¬ ì‹¤íŒ¨", order_id="ORD-123")

# ì»¨í…ìŠ¤íŠ¸ ë°”ì¸ë”©
logger = logger.bind(request_id="REQ-789")
logger.info("ì²˜ë¦¬ ì‹œì‘")  # request_id ìë™ í¬í•¨
logger.info("ì²˜ë¦¬ ì™„ë£Œ")  # request_id ìë™ í¬í•¨
```

**ì„¤ì •**:
| í™˜ê²½ | í¬ë§· | ë ˆë²¨ | ì¶œë ¥ |
|------|------|------|------|
| ê°œë°œ | Console (ì»¬ëŸ¬) | DEBUG | stdout |
| ìŠ¤í…Œì´ì§• | JSON | INFO | stdout + íŒŒì¼ |
| ìš´ì˜ | JSON | INFO | stdout + CloudWatch |

**í•„ìˆ˜ ì»¨í…ìŠ¤íŠ¸**:
- `trace_id`: ë¶„ì‚° ì¶”ì  ID (ìë™ ì£¼ì…)
- `user_id`: í˜„ì¬ ì‚¬ìš©ì (ì¸ì¦ í›„ ë°”ì¸ë”©)
- `request_id`: ìš”ì²­ ID (ë¯¸ë“¤ì›¨ì–´ì—ì„œ ë°”ì¸ë”©)

**ê¸ˆì§€ ì‚¬í•­**:
- âŒ `print()` ì‚¬ìš© ê¸ˆì§€ (Ruff T201)
- âŒ `logging.getLogger()` ì§ì ‘ ì‚¬ìš© ê¸ˆì§€
- âŒ ë¯¼ê° ì •ë³´ ë¡œê¹… ê¸ˆì§€ (ë¹„ë°€ë²ˆí˜¸, í† í°)

**Stage 5 êµ¬í˜„ í•­ëª©**:
- [ ] `logger.py` êµ¬í˜„
- [ ] `config.py` êµ¬í˜„
- [ ] `processors.py` êµ¬í˜„
- [ ] `tests/core/test_logging.py` ì‘ì„±
```

---

### ì˜ˆì‹œ: Error Handling ì‹œìŠ¤í…œ ì²­ì‚¬ì§„

```markdown
### 3.4 Error Handling ì‹œìŠ¤í…œ

**ADR ì°¸ì¡°**: ADR-404 (ì—ëŸ¬ ì²˜ë¦¬ í‘œì¤€)

**ë””ë ‰í† ë¦¬**: `src/core/errors/`

**íŒŒì¼ êµ¬ì„±**:
```
src/core/errors/
â”œâ”€â”€ __init__.py          # ì˜ˆì™¸ í´ë˜ìŠ¤ export
â”œâ”€â”€ exceptions.py        # ì˜ˆì™¸ ê³„ì¸µ ì •ì˜
â”œâ”€â”€ codes.py             # ì—ëŸ¬ ì½”ë“œ enum
â””â”€â”€ handlers.py          # FastAPI ì˜ˆì™¸ í•¸ë“¤ëŸ¬
```

**ì˜ˆì™¸ ê³„ì¸µ**:
```python
# ê¸°ë³¸ ì˜ˆì™¸
class AppError(Exception):
    code: str
    message: str
    status_code: int = 500

# ë„ë©”ì¸ ì˜ˆì™¸
class DomainError(AppError):
    status_code: int = 400

class NotFoundError(DomainError):
    status_code: int = 404

class ValidationError(DomainError):
    status_code: int = 400

class ConflictError(DomainError):
    status_code: int = 409

# ì™¸ë¶€ ì‹œìŠ¤í…œ ì˜ˆì™¸
class ExternalError(AppError):
    status_code: int = 502

class KISAPIError(ExternalError):
    pass
```

**ì—ëŸ¬ ì½”ë“œ ì²´ê³„**:
```python
class ErrorCode(str, Enum):
    # ë„ë©”ì¸ ì—ëŸ¬ (1xxx)
    ORDER_NOT_FOUND = "1001"
    ORDER_ALREADY_SUBMITTED = "1002"
    INSUFFICIENT_BALANCE = "1003"
    
    # ì™¸ë¶€ API ì—ëŸ¬ (2xxx)
    KIS_API_RATE_LIMITED = "2001"
    KIS_API_TIMEOUT = "2002"
    
    # ì‹œìŠ¤í…œ ì—ëŸ¬ (9xxx)
    DATABASE_ERROR = "9001"
    CACHE_ERROR = "9002"
```

**ì‚¬ìš© ì˜ˆì‹œ**:
```python
from core.errors import NotFoundError, ErrorCode

# ì˜ˆì™¸ ë°œìƒ
raise NotFoundError(
    code=ErrorCode.ORDER_NOT_FOUND,
    message="ì£¼ë¬¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",
    order_id="ORD-123"
)

# API ì‘ë‹µ (ìë™ ë³€í™˜)
{
    "error": {
        "code": "1001",
        "message": "ì£¼ë¬¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",
        "details": {"order_id": "ORD-123"}
    }
}
```

**ê¸ˆì§€ ì‚¬í•­**:
- âŒ ì¼ë°˜ `Exception` raise ê¸ˆì§€
- âŒ `except: pass` ê¸ˆì§€
- âŒ ì—ëŸ¬ ì½”ë“œ ì—†ì´ ì˜ˆì™¸ ë°œìƒ ê¸ˆì§€

**Stage 5 êµ¬í˜„ í•­ëª©**:
- [ ] `exceptions.py` êµ¬í˜„
- [ ] `codes.py` êµ¬í˜„
- [ ] `handlers.py` êµ¬í˜„
- [ ] `tests/core/test_errors.py` ì‘ì„±
```

---

## âœ… Stage 4 ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸

```
â–¡ ì‹œìŠ¤í…œ ì„ íƒ
  â–¡ íŒ¨ë°€ë¦¬ í™•ì¸ (01C-01)
  â–¡ í•„ìˆ˜ ì‹œìŠ¤í…œ 5ê°œ í™•ì¸
  â–¡ íŒ¨ë°€ë¦¬ë³„ í•„ìˆ˜ ì‹œìŠ¤í…œ ê²°ì •
  â–¡ ì„ íƒ ì‹œìŠ¤í…œ ê²°ì • + ê·¼ê±°
  â–¡ ì œì™¸ ì‹œìŠ¤í…œ ëª…ì‹œ + ì¶”ê°€ ì‹œì 

â–¡ ë””ë ‰í† ë¦¬ êµ¬ì¡°
  â–¡ src/core/ êµ¬ì¡° ì„¤ê³„
  â–¡ tests/ êµ¬ì¡° ì„¤ê³„
  â–¡ ê° ì‹œìŠ¤í…œë³„ íŒŒì¼ ëª©ë¡

â–¡ ê° ì‹œìŠ¤í…œ ìƒì„¸
  â–¡ ê³µê°œ API ì •ì˜
  â–¡ ì„¤ì • í•­ëª© ì •ì˜
  â–¡ ê¸ˆì§€ ì‚¬í•­ ëª…ì‹œ
  â–¡ Stage 5 êµ¬í˜„ í•­ëª© ëª©ë¡

â–¡ êµ¬í˜„ ê³„íš
  â–¡ ì˜ì¡´ì„± ê·¸ë˜í”„ ì‘ì„±
  â–¡ êµ¬í˜„ ìˆœì„œ ê²°ì •
  â–¡ ì˜ˆìƒ ì‹œê°„ ì‚°ì •

â–¡ ì‚°ì¶œë¬¼ ìƒì„±
  â–¡ 04B-01_dna_blueprint.md ì‘ì„±
  â–¡ (ì„ íƒ) ì‹œìŠ¤í…œë³„ ë¶„ë¦¬ ë¬¸ì„œ
```

---

## ğŸ”œ ë‹¤ìŒ ë‹¨ê³„

### Stage 4 â†’ Stage 5 ì „ë‹¬ ì‚¬í•­

| í•­ëª© | ì˜ˆì‹œ | Stage 5ì—ì„œ ì‚¬ìš© |
|------|------|-----------------|
| DNA ì²­ì‚¬ì§„ | 04B-01_dna_blueprint.md | êµ¬í˜„ ê°€ì´ë“œ |
| ì‹œìŠ¤í…œë³„ ìƒì„¸ | ê° ì‹œìŠ¤í…œ ì„¤ê³„ | ì½”ë“œ êµ¬í˜„ |
| êµ¬í˜„ ìˆœì„œ | ì˜ì¡´ì„± ê¸°ë°˜ ìˆœì„œ | ì‘ì—… ìŠ¤ì¼€ì¤„ |

### Stage 5ì—ì„œ í•  ì¼
- ğŸ”„ ì²­ì‚¬ì§„ ê¸°ë°˜ src/core/ ëª¨ë“ˆ êµ¬í˜„
- ğŸ”„ ê° ì‹œìŠ¤í…œë³„ í…ŒìŠ¤íŠ¸ ì‘ì„±
- ğŸ”„ í†µí•© í…ŒìŠ¤íŠ¸ë¡œ ì‹œìŠ¤í…œ ê°„ ì—°ë™ ê²€ì¦

**ë‹¤ìŒ ë¬¸ì„œ**: `05G-00_dna_implementation_guide.md`

---

## âª ì´ì „ Stage ê²€ì¦ ë° ìˆ˜ì • í”„ë¡œí† ì½œ

### ê²€ì¦ ì‹œì 
- Stage 4 ì‹œì‘ ì „ í•„ìˆ˜ ì²´í¬
- DNA ì‹œìŠ¤í…œ ì„ íƒ í›„ ADRê³¼ êµì°¨ ê²€ì¦

### ê²€ì¦ ëŒ€ìƒ

| Stage | ì‚°ì¶œë¬¼ | ê²€ì¦ í•­ëª© |
|-------|--------|----------|
| Stage 1 | 01C-01_*.md | DNA ìˆ˜ì¤€ì´ íŒ¨ë°€ë¦¬ íŠ¹ì„±ì— ì í•©? |
| Stage 2 | 02C-01_*.md | ê¸°ìˆ  ì œì•½ì´ DNA ì„ íƒì— ë°˜ì˜? |
| Stage 3 | 03A-*_*.md | ADR ê²°ì •ì´ DNA ì„¤ê³„ì— ë°˜ì˜? |

### ì˜¤ë¥˜ ë°œê²¬ ì‹œ í”„ë¡œí† ì½œ

```
Stage 4ì—ì„œ Stage 1-3 ì˜¤ë¥˜ ë°œê²¬ ì‹œ:

Step 1: ì˜¤ë¥˜ ë°œê²¬ ë° ë¬¸ì„œí™”
â”œâ”€ ë°œê²¬ ìœ„ì¹˜: DNA ì‹œìŠ¤í…œ [N] ì„¤ê³„ ì¤‘
â”œâ”€ ì˜¤ë¥˜ ë‚´ìš©: [êµ¬ì²´ì  ì„¤ëª…]
â”œâ”€ ì˜í–¥ Stage: Stage [1, 2, ë˜ëŠ” 3]
â””â”€ ê¸°ë¡: 04B-01ì— "ë°œê²¬ëœ ì´ìŠˆ" ì¶”ê°€

Step 2: ì˜í–¥ ë²”ìœ„ íŒŒì•…
â”œâ”€ Stage 1: íŒ¨ë°€ë¦¬/NFR ìˆ˜ì • í•„ìš”?
â”œâ”€ Stage 2: ì œì•½/ì¶©ëŒ ìˆ˜ì • í•„ìš”?
â”œâ”€ Stage 3: ADR ìˆ˜ì •/ì¶”ê°€ í•„ìš”?
â””â”€ ì¬ì‘ì—… ì˜ˆìƒ: [X]ì‹œê°„

Step 3: í•´ë‹¹ Stageë¡œ ì´ë™ â†’ ìˆ˜ì •
â”œâ”€ í•´ë‹¹ ì‚°ì¶œë¬¼ ìˆ˜ì •
â”œâ”€ ë²„ì „ ì—…ë°ì´íŠ¸
â””â”€ ìˆ˜ì • ê²€ì¦

Step 4: ì¤‘ê°„ Stage ì „íŒŒ (í•´ë‹¹ ì‹œ)
â”œâ”€ Stage 2, 3 ì˜í–¥ í™•ì¸
â””â”€ í•„ìš” ì‹œ ìˆ˜ì •

Step 5: Stage 4 ì¬ì§„í–‰
â”œâ”€ ìˆ˜ì •ëœ ì…ë ¥ìœ¼ë¡œ DNA ì²­ì‚¬ì§„ ì¬ê²€í† 
â””â”€ ì¼ê´€ì„± í™•ì¸

Step 6: ê²€ì¦ â†’ Stage 5 ì „ë‹¬ âœ…
```

### í”í•œ ì˜¤ë¥˜ íŒ¨í„´

| ì˜¤ë¥˜ ìœ í˜• | ì˜ˆì‹œ | í•´ê²° |
|----------|------|------|
| ADR ëˆ„ë½ | ë¡œê¹… ë ˆë²¨ ê²°ì • ì—†ì´ DNA ì„¤ê³„ | Stage 3 ADR ì¶”ê°€ |
| íŒ¨ë°€ë¦¬ ë¶ˆì¼ì¹˜ | ì‹¤ì‹œê°„ì¸ë° L2 ë¡œê¹… ì„ íƒ | Stage 1 ì¬ê²€í†  ë˜ëŠ” DNA ìˆ˜ì¤€ ìƒí–¥ |
| ì œì•½ ë¯¸ë°˜ì˜ | íŒ€ ê²½í—˜ ì—†ëŠ” ê¸°ìˆ  DNAì— í¬í•¨ | Stage 2 ì œì•½ ë°˜ì˜ |

### ì¶”ì ì„±

```
ìˆ˜ì • ì´ë ¥: docs/revision_log.md
```

---

## ğŸ“š ì°¸ê³  ë¬¸ì„œ

| ë¬¸ì„œ | ìš©ë„ |
|------|------|
| `DNA_METHODOLOGY_DETAILED.md` Part 5 | Stage 4-6 ìƒì„¸ ì›ë¦¬ |
| `DNA_Systems_11_Complete_Guide.md` | DNA ì‹œìŠ¤í…œ ìƒì„¸ ì„¤ëª… |
| `./standards/00_STAGE_STRUCTURE.md` | Stage ê°„ ì—°ê²° êµ¬ì¡° |

---

## ğŸ’¡ í•µì‹¬ ì›ì¹™ ìš”ì•½

```
DNA ì²­ì‚¬ì§„ ì‘ì„±ì˜ 3ê°€ì§€ ì›ì¹™:

1. íŒ¨ë°€ë¦¬ ê¸°ë°˜ ì„ íƒ
   - ëª¨ë“  íŒ¨ë°€ë¦¬ ê³µí†µ 5ê°œ í•„ìˆ˜
   - íŒ¨ë°€ë¦¬ë³„ ì¶”ê°€ ì‹œìŠ¤í…œ ì„ íƒ
   - ì œì™¸ ì‹œìŠ¤í…œë„ ê·¼ê±°ì™€ ì¶”ê°€ ì‹œì  ëª…ì‹œ

2. ì˜ì¡´ì„± ê¸°ë°˜ ìˆœì„œ
   - Types â†’ Config â†’ Logging â†’ Error
   - ì˜ì¡´ì„± ì—†ëŠ” ê²ƒë¶€í„° êµ¬í˜„
   - í…ŒìŠ¤íŠ¸ëŠ” ì¤‘ê°„ì— (ê¸°ë°˜ 4ê°œ í›„)

3. ì¸í„°í˜ì´ìŠ¤ ìš°ì„ 
   - ê³µê°œ API ë¨¼ì € ì •ì˜
   - ì‚¬ìš©ë²• ì˜ˆì‹œ ì œê³µ
   - ê¸ˆì§€ ì‚¬í•­ ëª…í™•íˆ
```

```
Bridge(Stage 4-6)ì˜ 4ëŒ€ êµ¬ì„±ìš”ì†Œ:

1. ì„±ë¬¸í™”ëœ ê²°ì • (Stage 3)
   = ADR ë¬¸ì„œ
   â†’ ë¹„ìœ : ë²•ë¥ 

2. ì²­ì‚¬ì§„ (Stage 4)
   = DNA ì‹œìŠ¤í…œ ì„¤ê³„
   â†’ ë¹„ìœ : ê±´ì¶• ë„ë©´

3. êµ¬í˜„ëœ ì½”ë“œ (Stage 5)
   = src/core/ ëª¨ë“ˆ
   â†’ ë¹„ìœ : ê³µêµ¬

4. ê°•ì œ ê·œì¹™ (Stage 6)
   = PROJECT_STANDARDS.md
   â†’ ë¹„ìœ : êµí†µë²•ê·œ
```

---

**ë²„ì „ ì´ë ¥**:
- v5.0 (2025-12-03): Gemini ì—°êµ¬ ê¸°ë°˜ ì „ë©´ ì¬ì‘ì„±, DNA_METHODOLOGY_DETAILED.md ê¸°ì¤€
- v1.0 (2025-11-13): ì´ˆê¸° ë²„ì „
